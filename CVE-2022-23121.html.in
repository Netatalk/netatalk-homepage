<div id="content">
<h1>Netatalk Security Advisory</h1>

<dl>
<dt><strong>Subject</strong></dt>
<dd>Arbitrary code execution in parse_entries</dd>
<dt><strong>CVE ID</strong></dt>
<dd><a href="https://www.cve.org/CVERecord?id=CVE-2022-23121">CVE-2022-23121</a></dd>
<dt><strong>Date of Publishing</strong></dt>
<dd>2022/03/21 <i>advisory published retroactively; date is approximate</i></dd>
<dt><strong>Affected Netatalk Versions</strong></dt>
<dd>3.0.0 - 3.1.12</dd>
<dd>1.5.0 - 2.2.6</dd>
<dt><strong>Summary</strong></dt>
<dd>Lack of proper error handling leads to remote code execution in the parse_entries function</dd>
</dl>
<h2>Description</h2>
<p>This vulnerability allows remote attackers to execute arbitrary code on affected installations of Netatalk.
Authentication is not required to exploit this vulnerability.
The specific flaw exists within the parse_entries function.
The issue results from the lack of proper error handling when parsing AppleDouble entries.
An attacker can leverage this vulnerability to execute code in the context of root.</p>

<h2>Patch Availability</h2>
<p>Apply the patches with git hashes
<a href="https://github.com/Netatalk/netatalk/commit/0c0465e4e85a27105b61b3918df8f8df0565367c.diff">
0c0465e</a> and
<a href="https://github.com/Netatalk/netatalk/commit/62d4013c62be3b1b4a14f37057cb1c8f393c5fd1.diff">
62d4013</a> to hotfix your local Netatalk deployment.</p>

<p>Additionally, Netatalk 3.1.13 and 2.2.7 have been released which contains the security patch.
Netatalk administrators are advised to upgrade to this version or apply the patch as soon as possible.</p>

<h2>CVSS Calculation</h2>
<p>CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (9.8)</p>

<h2>Workaround</h2>
<p>Configure Netatalk to use Extended Attributes (EA) instead of AppleDouble v2 to store metadata.
This is the default configuration in Netatalk 3.0 and later.</p>

<h2>Credits</h2>
<dl>
<dt>Vulnerability found and reported by:</dt>
<dd>NCC Group EDG (Alex Plaskett, Cedric Halbronn, Aaron Adams)</dd>
<dt>Patch developed by:</dt>
<dd>Ralph Boehme of the Netatalk and Samba teams</dd>
</dl>

</div>
