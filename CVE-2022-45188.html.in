<div id="content">
<h1>Netatalk Security Advisory</h1>

<dl>
<dt><strong>Subject</strong></dt>
<dd>Arbitrary code execution in afp_getappl</dd>
<dt><strong>CVE ID</strong></dt>
<dd><a href="https://www.cve.org/CVERecord?id=CVE-2022-45188">CVE-2022-45188</a></dd>
<dt><strong>Date of Publishing</strong></dt>
<dd>2023/03/26</dd>
<dt><strong>Affected Netatalk Versions</strong></dt>
<dd>3.0.0 - 3.1.14</dd>
<dd>1.5.0 - 2.2.8</dd>
<dt><strong>Summary</strong></dt>
<dd>Heap-based buffer overflow resulting in code execution via a crafted .appl file</dd>
</dl>
<h2>Description</h2>
<p>Netatalk has an afp_getappl heap-based buffer overflow resulting in code execution via a crafted .appl file.
This provides remote root access on some platforms such as FreeBSD (demonstrated on TrueNAS).</p>

<h2>Patch Availability</h2>
<p>Apply the patch with git hash
<a href="https://github.com/Netatalk/netatalk/commit/dfab56846e8f454fe0548347ae6437bd12a05925.diff">
dfab568</a> to hotfix your local Netatalk deployment.</p>

<p>Additionally, Netatalk 3.1.15 and 2.2.9 have been released which contains the security patch.
Netatalk administrators are advised to upgrade to this version or apply the patch as soon as possible.</p>

<h2>CVSSv3 Calculation</h2>
<p>CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H (7.8)</p>

<h2>Workaround</h2>
<p>None.</p>

<h2>Credits</h2>
<dl>
<dt>Vulnerability found and reported by:</dt>
<dd><a href="https://rushbnt.github.io/bug%20analysis/netatalk-0day/">rushbnt</a></dd>
<dt>Patch developed by:</dt>
<dd>dgsga of the Netatalk team</dd>
</dl>

</div>
