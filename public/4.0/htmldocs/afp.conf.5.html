<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>afp.conf</title>
    <link rel="stylesheet" type="text/css" href="/css/netatalk.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="home" href="index.html" title="Netatalk Manual" />
    <link rel="up" href="man-pages.html" title="Chapter 6. Manual Pages" />
    <link rel="prev" href="aecho.1.html" title="aecho" />
    <link rel="next" href="afp_signature.conf.5.html" title="afp_signature.conf" />
  </head>
  <body>
    <div xmlns="" id="header">
        <div id="logo"></div>
        <div id="menlinks">
          <a href="/" title="Return to Netatalk home">[main]</a>
          <a href="/docs" title="Netatalk Wiki">[wiki]</a>
          <a href="/documentation.html" title="Netatalk Manual">[documentation]</a>
          <a href="/download.html" title="Download Netatalk">[downloads]</a>
          <a href="/support.html" title="Support">[support]</a>
          <a href="/links.html" title="Netatalk related links">[links]</a>
          <img src="/gfx/end.gif" alt="" width="125" height="7" />
        </div>
    </div>
    <div xmlns="" class="navheader" align="center">Netatalk 4.0.3</div>
<div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">afp.conf</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="aecho.1.html">Prev</a> </td><th width="60%" align="center">Chapter 6. Manual Pages</th><td width="20%" align="right"> <a accesskey="n" href="afp_signature.conf.5.html">Next</a></td></tr></table><hr /></div><div class="refentry"><a id="afp.conf.5"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>afp.conf — Netatalk configuration file</p></div><div class="refsect1"><a id="id-1.9.6.3"></a><h2>Synopsis</h2><p>The <code class="filename">afp.conf</code> file is the configuration file for
    the <span class="bold"><strong>Netatalk</strong></span> AFP file server.</p><p>All AFP-specific configurations and AFP volume definitions are done
    via this file.</p></div><div class="refsect1"><a id="FILEFORMATSECT"></a><h2>File Format</h2><p>The file consists of sections and parameters. A section begins with
    the name of the section in square brackets and continues until the next
    section begins. Sections contain parameters of the form:</p><pre class="programlisting">
    <em class="replaceable"><code>name</code></em> = <em class="replaceable"><code>value </code></em>
    </pre><p>The file is line-based - that is, each newline-terminated line
    represents either a comment, a section name or a parameter.</p><p>Section and parameter names are case sensitive.</p><p>Only the first equals sign in a parameter is significant. Whitespace
    before or after the first equals sign is discarded. Leading, trailing and
    internal whitespace in section and parameter names is irrelevant. Leading
    and trailing whitespace in a parameter value is discarded. Internal
    whitespace within a parameter value is retained verbatim.</p><p>Any line beginning with a semicolon (<span class="quote">“<span class="quote">;</span>”</span>) or a hash
    (<span class="quote">“<span class="quote">#</span>”</span>) character is ignored, as are lines containing only
    whitespace.</p><p>Any line ending in a <span class="quote">“<span class="quote"> <code class="literal">\</code> </span>”</span> is
    continued on the next line in the customary UNIX fashion.</p><p>The values following the equals sign in parameters are all either a
    string (no quotes needed) or a boolean, which may be given as yes/no, 1/0
    or true/false. Case is not significant in boolean values, but is preserved
    in string values. Some items such as "file perm"s are numeric.</p><p>The parameter <code class="option">include =
    <em class="replaceable"><code>path</code></em></code> allows you to include one config
    file inside another. The file is included literally, as though typed in
    place. Nested includes are not supported.</p></div><div class="refsect1"><a id="id-1.9.6.5"></a><h2>Section Descriptions</h2><p>Each section in the configuration file (except for the [Global]
    section) describes a shared resource (known as a <span class="quote">“<span class="quote">volume</span>”</span>).
    The section name is the name of the volume and the parameters within the
    section define the volume attributes and options.</p><p>There are two special sections, [Global] and [Homes], which are
    described under <span class="emphasis"><em>special sections</em></span>. The following notes
    apply to ordinary section descriptions.</p><p>A volume consists of a directory to which access is being given plus
    a description of the access rights which are granted to the user of the
    service. For volumes the <code class="option">path</code> option must specify the
    directory to share.</p><p>Any volume section without <code class="option">path</code> option is
    considered a <span class="emphasis"><em>vol preset</em></span> which can be selected in
    other volume sections via the <code class="option">vol preset</code> option and
    constitutes defaults for the volume. For any option specified both in a
    preset <span class="emphasis"><em>and</em></span> in a volume section the volume section
    setting completely substitutes the preset option.</p><p>The access rights granted by the server are masked by the access
    rights granted to the specified or guest UNIX user by the host system. The
    server does not grant more access than the host system grants.</p><p>The following sample section defines an AFP volume. The user has
    full access to the path <code class="filename">/foo/bar</code>. The share is
    accessed via the share name <code class="literal">baz</code>: </p><pre class="programlisting"> [baz]
    path = /foo/bar </pre></div><div class="refsect1"><a id="id-1.9.6.6"></a><h2>Special Sections</h2><div class="refsect2"><a id="id-1.9.6.6.2"></a><h3>The [Global] section</h3><p>Parameters in this section apply to the server as a whole.
      Parameters denoted by a (G) below are must be set in this
      section.</p></div><div class="refsect2"><a id="id-1.9.6.6.3"></a><h3>The [Homes] section</h3><p>This section enable sharing of the UNIX server user home
      directories. Specifying an optional <code class="option">path</code> parameter
      means that not the whole user home will be shared but the subdirectory
      <code class="option">path</code>. It is necessary to define the <code class="option">basedir
      regex</code> option. It should be a regex which matches the parent
      directory of the user homes. Parameters denoted by a (H) belong to
      volume sections. The optional parameter <code class="option">home name</code> can
      be used to change the AFP volume name which <span class="emphasis"><em>$u's
      home</em></span> by default. See below under VARIABLE
      SUBSTITUTIONS.</p><p>The following example illustrates this. Given all user home
      directories are stored under <code class="filename">/home</code>:
      </p><pre class="programlisting"> [Homes]
      path = afp-data
      basedir regex = /home</pre><p> For a user
      <span class="emphasis"><em>john</em></span> this results in an AFP home volume with a path
      of <code class="filename">/home/john/afp-data</code>.</p><p>If <code class="option">basedir regex</code> contains symlink, set the
      canonicalized absolute path. When <code class="filename">/home</code> links to
      <code class="filename">/usr/home</code>: </p><pre class="programlisting"> [Homes]
      basedir regex = /usr/home</pre></div></div><div class="refsect1"><a id="id-1.9.6.7"></a><h2>Parameters</h2><p>Parameters define the specific attributes of sections.</p><p>Some parameters are specific to the [Global] section (e.g.,
    <span class="emphasis"><em>log type</em></span>). All others are permissible only in volume
    sections. The letter <span class="emphasis"><em>G</em></span> in parentheses indicates that
    a parameter is specific to the [Global] section. The letter
    <span class="emphasis"><em>V</em></span> indicates that a parameter can be specified in a
    volume specific section.</p></div><div class="refsect1"><a id="id-1.9.6.8"></a><h2>Variable Substitutions</h2><p>You can use variables in volume names. The use of variables in paths
    is limited to $u.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>if you specify an unknown variable, it will not get
        converted.</p></li><li class="listitem"><p>if you specify a known variable, but that variable doesn't have
        a value, it will get ignored.</p></li></ol></div><p>The variables which can be used for substitutions are:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">$b</span></dt><dd><p>basename</p></dd><dt><span class="term">$c</span></dt><dd><p>client's ip address</p></dd><dt><span class="term">$d</span></dt><dd><p>volume pathname on server</p></dd><dt><span class="term">$f</span></dt><dd><p>full name (contents of the gecos field in the passwd
          file)</p></dd><dt><span class="term">$g</span></dt><dd><p>group name</p></dd><dt><span class="term">$h</span></dt><dd><p>hostname</p></dd><dt><span class="term">$i</span></dt><dd><p>client's ip, without port</p></dd><dt><span class="term">$s</span></dt><dd><p>server name (this can be the hostname)</p></dd><dt><span class="term">$u</span></dt><dd><p>user name (if guest, it is the user that guest is running
          as)</p></dd><dt><span class="term">$v</span></dt><dd><p>volume name</p></dd><dt><span class="term">$$</span></dt><dd><p>prints dollar sign ($)</p></dd></dl></div></div><div class="refsect1"><a id="id-1.9.6.9"></a><h2>Explanation of Global Parameters</h2><div class="refsect2"><a id="id-1.9.6.9.2"></a><h3>Authentication Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">ad domain = <em class="parameter"><code>DOMAIN</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Append @DOMAIN to username when authenticating. Useful in
            Active Directory environments that otherwise would require the
            user to enter the full user@domain string.</p></dd><dt><span class="term">admin auth user = <em class="parameter"><code>user</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifying e.g. "<code class="option">admin auth user = root</code>"
            whenever a normal user login fails, afpd will try to authenticate
            as the specified <code class="option">admin auth user</code>. If this
            succeeds, a normal session is created for the original connecting
            user. Said differently: if you know the password of <code class="option">admin
            auth user</code>, you can authenticate as any other user.</p></dd><dt><span class="term">admin group = <em class="replaceable"><code>group</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Allows users of a certain group to be seen as the superuser
            when they log in. This option is disabled by default.</p></dd><dt><span class="term">force user = <em class="replaceable"><code>USER</code></em>
          <span class="type">(G)</span></span></dt><dd><p>This specifies a UNIX user name that will be assigned as the
            default user for all users connecting to this server. This is
            useful for sharing files. You should also use it carefully as
            using it incorrectly can cause security problems.</p></dd><dt><span class="term">force group = <em class="replaceable"><code>GROUP</code></em>
          <span class="type">(G)</span></span></dt><dd><p>This specifies a UNIX group name that will be assigned as
            the default primary group for all users connecting to this
            server.</p></dd><dt><span class="term">k5 keytab = <em class="replaceable"><code>path</code></em>
          <span class="type">(G)</span>, </span><span class="term">k5 service = <em class="replaceable"><code>service</code></em>
          <span class="type">(G)</span>, </span><span class="term">k5 realm = <em class="replaceable"><code>realm</code></em>
          <span class="type">(G)</span></span></dt><dd><p>These are required if the server supports the Kerberos 5
            authentication UAM.</p></dd><dt><span class="term">nt domain = <em class="parameter"><code>DOMAIN</code></em>
          <span class="type">(G)</span>, </span><span class="term">nt separator = <em class="parameter"><code>SEPARATOR</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Use for e.g. winbind authentication, prepends both strings
            before the username from login and then tries to authenticate with
            the result through the available and active UAM authentication
            modules.</p></dd><dt><span class="term">save password = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Enables or disables the ability of clients to save passwords
            locally.</p></dd><dt><span class="term">set password = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Enables or disables the ability of clients to change their
            passwords via chooser or the "connect to server" dialog.</p></dd><dt><span class="term">uam list = <em class="replaceable"><code>uam list</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Space or comma separated list of UAMs. (The default is
            "uams_dhx.so uams_dhx2.so").</p><p>The most commonly used UAMs are:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">uams_guest.so</span></dt><dd><p>allows guest logins</p></dd><dt><span class="term">uams_clrtxt.so</span></dt><dd><p>(uams_pam.so or uams_passwd.so) Allow logins with
                  passwords transmitted in the clear. (legacy)</p></dd><dt><span class="term">uams_randnum.so</span></dt><dd><p>allows Random Number and Two-Way Random Number
                  Exchange for authentication (requires a separate file
                  containing the passwords, either the default afppasswd file
                  or the one specified via "<code class="option">passwd file</code>").
                  See <span class="citerefentry"><span class="refentrytitle">afppasswd</span>(1)</span> for details. (legacy)</p></dd><dt><span class="term">uams_dhx.so</span></dt><dd><p>(uams_dhx_pam.so or uams_dhx_passwd.so) Allow
                  Diffie-Hellman eXchange (DHX) for authentication.</p></dd><dt><span class="term">uams_dhx2.so</span></dt><dd><p>(uams_dhx2_pam.so or uams_dhx2_passwd.so) Allow
                  Diffie-Hellman eXchange 2 (DHX2) for authentication.</p></dd><dt><span class="term">uam_gss.so</span></dt><dd><p>Allow Kerberos V for authentication (optional)</p></dd></dl></div></dd><dt><span class="term">uam path = <em class="replaceable"><code>path</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the default path for UAMs for this server.</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.9.3"></a><h3>Charset Options</h3><p>With OS X Apple introduced the AFP3 protocol. One of the big
      changes was, that AFP3 uses Unicode names encoded as Decomposed UTF-8
      (UTF8-MAC). Previous AFP/OS versions used charsets like MacRoman,
      MacCentralEurope, etc.</p><p>To be able to serve AFP3 and older clients at the same time,
      <span class="command"><strong>afpd</strong></span> needs to be able to convert between UTF-8 and
      Mac charsets. Even OS X clients partly still rely on the mac charset. As
      there's no way, <span class="command"><strong>afpd</strong></span> can detect the codepage a pre
      AFP3 client uses, you have to specify it using the <code class="option">mac
      charset</code> option. The default is MacRoman, which should be fine
      for most western users.</p><p>As <span class="command"><strong>afpd</strong></span> needs to interact with UNIX operating
      system as well, it needs to be able to convert from UTF8-MAC / Mac
      charset to the UNIX charset. By default <span class="command"><strong>afpd</strong></span> uses
      <span class="emphasis"><em>UTF8</em></span>. You can set the UNIX charset using the
      <code class="option">unix charset</code> option. If you're using extended
      characters in the configuration files for <span class="command"><strong>afpd</strong></span>, make
      sure your terminal matches the <code class="option">unix charset</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">mac charset = <em class="parameter"><code>CHARSET</code></em>
          <span class="type">(G)/(V)</span></span></dt><dd><p>Specifies the Mac clients charset, e.g.
            <span class="emphasis"><em>MAC_ROMAN</em></span>. This is used to convert strings
            and filenames to the clients codepage for OS9 and Classic, i.e.
            for authentication and AFP messages (SIGUSR2 messaging). This will
            also be the default for the volumes <code class="option">mac charset</code>.
            Defaults to <span class="emphasis"><em>MAC_ROMAN</em></span>.</p></dd><dt><span class="term">unix charset = <em class="parameter"><code>CHARSET</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies the servers unix charset, e.g.
            <span class="emphasis"><em>ISO-8859-15</em></span> or <span class="emphasis"><em>EUC-JP</em></span>.
            This is used to convert strings to/from the systems locale, e.g.
            for authentication, server messages and volume names. If
            <span class="emphasis"><em>LOCALE</em></span> is set, the systems locale is used.
            Defaults to <span class="emphasis"><em>UTF8</em></span>.</p></dd><dt><span class="term">vol charset = <em class="parameter"><code>CHARSET</code></em>
          <span class="type">(G)/(V)</span></span></dt><dd><p>Specifies the encoding of the volumes filesystem. By
            default, it is the same as <code class="option">unix charset</code>.</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.9.4"></a><h3>Password Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">passwd file = <em class="parameter"><code>path</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the path to the Randnum UAM passwd file for this
            server.</p></dd><dt><span class="term">passwd minlen = <em class="parameter"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the minimum password length, if supported by the
            UAM</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.9.5"></a><h3>Network Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">advertise ssh = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Allows old Mac OS X clients (10.3.3-10.4) to automagically
            establish a tunneled AFP connection through SSH. If this option is
            set, the server's answers to client's FPGetSrvrInfo requests
            contain an additional entry. It depends on both client's settings
            and a correctly configured and running <span class="citerefentry"><span class="refentrytitle">sshd</span>(8)</span> on the server to let things work.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Setting this option is not recommended since globally
              encrypting AFP connections via SSH will increase the server's
              load significantly. On the other hand, Apple's client side
              implementation of this feature in MacOS X versions prior to
              10.3.4 contained a security flaw.</p></div></dd><dt><span class="term">afp interfaces = <em class="replaceable"><code>name [name ...]</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies the network interfaces that the server should
            listens on. The default is advertise the first IP address of the
            system, but to listen for any incoming request.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Do not use at the same time as the <code class="option">afp
              listen</code> option.</p></div></dd><dt><span class="term">afp listen = <em class="replaceable"><code>ip address[:port] [ip address[:port]
          ...]</code></em> <span class="type">(G)</span></span></dt><dd><p>Specifies the IP address that the server should advertise
            <span class="bold"><strong>and</strong></span> listens to. The default is
            advertise the first IP address of the system, but to listen for
            any incoming request. The network address may be specified either
            in dotted-decimal format for IPv4 or in hexadecimal format for
            IPv6.</p><p>IPv6 address + port combination must use URL the format
            using square brackets [IPv6]:port</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Do not use at the same time as the <code class="option">afp
              interfaces</code> option.</p></div></dd><dt><span class="term">afp port = <em class="replaceable"><code>port number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Allows a different TCP port to be used for AFP. The default
            is 548. Also sets the default port applied when none specified in
            an <code class="option">afp listen</code> option.</p></dd><dt><span class="term">appletalk = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Enables support for AFP-over-Appletalk. This option requires
            that your operating system supports the AppleTalk networking
            protocol.</p></dd><dt><span class="term">cnid listen = <em class="replaceable"><code>ip address[:port] [ip
          address[:port] ...]</code></em> <span class="type">(G)</span></span></dt><dd><p>Specifies the IP address that the CNID server should listen
            on. The default is <span class="bold"><strong>localhost:4700</strong></span>.</p></dd><dt><span class="term">ddp address = <em class="replaceable"><code>ddp address</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies the DDP address of the server. The default is to
            auto-assign an address (0.0). This is only useful if you are
            running AppleTalk on more than one interface.</p></dd><dt><span class="term">ddp zone = <em class="replaceable"><code>ddp zone</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies the AppleTalk zone to register the server in. The
            default is to register the server in the default zone of the last
            interface configured by the system.</p></dd><dt><span class="term">disconnect time = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Keep disconnected AFP sessions for
            <em class="parameter"><code>number</code></em> hours before dropping them. Default
            is 24 hours.</p></dd><dt><span class="term">dsireadbuf = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Scale factor that determines the size of the DSI/TCP
            readahead buffer, default is 12. This is multiplies with the DSI
            server quantum (default 1MiB) to give the size of the buffer.
            Increasing this value might increase throughput in fast local
            networks for volume to volume copies. <span class="emphasis"><em>Note</em></span>:
            This buffer is allocated per afpd child process, so specifying
            large values will eat up large amount of memory (buffer size *
            number of clients).</p></dd><dt><span class="term">fqdn = <em class="replaceable"><code>name[:port]</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies a fully-qualified domain name, with an optional
            port. This is discarded if the server cannot resolve it. This
            option is not honored by AppleShare clients &lt;= 3.8.3. This
            option is disabled by default. Use with caution as this will
            involve a second name resolution step on the client side. Also
            note that afpd will advertise this name:port combination but not
            automatically listen to it.</p></dd><dt><span class="term">hostname = <em class="replaceable"><code>name</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Use this instead of the result from calling hostname for
            determining which IP address to advertise, therefore the hostname
            is resolved to an IP which is the advertised. This is NOT used for
            listening and it is also overwritten by <code class="option">afp
            listen</code>.</p></dd><dt><span class="term">max connections = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the maximum number of clients that can simultaneously
            connect to the server (default is 200).</p></dd><dt><span class="term">server quantum = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>This specifies the DSI server quantum. The default value is
            0x100000 (1 MiB). The maximum value is 0xFFFFFFFFF, the minimum is
            32000. If you specify a value that is out of range, the default
            value will be set. Do not change this value unless you're
            absolutely sure, what you're doing</p></dd><dt><span class="term">sleep time = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Keep sleeping AFP sessions for <em class="parameter"><code>number</code></em>
            hours before disconnecting clients in sleep mode. Default is 10
            hours.</p></dd><dt><span class="term">tcprcvbuf = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Try to set TCP receive buffer using setsockopt(). Often OSes
            impose restrictions on the applications ability to set this
            value.</p></dd><dt><span class="term">tcpsndbuf = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Try to set TCP send buffer using setsockopt(). Often OSes
            impose restrictions on the applications ability to set this
            value.</p></dd><dt><span class="term">recvfile = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to use splice() on Linux for receiving data.</p></dd><dt><span class="term">splice size = <em class="replaceable"><code>number</code></em> (default:
          <span class="emphasis"><em>64k</em></span>) <span class="type">(G)</span></span></dt><dd><p>Maximum number of bytes spliced.</p></dd><dt><span class="term">use sendfile = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to use sendfile<a id="id-1.9.6.9.5.2.20.2.1.1" class="indexterm"></a> syscall for sending file data to clients.</p></dd><dt><span class="term">zeroconf = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to use automatic Zeroconf<a id="id-1.9.6.9.5.2.21.2.1.1" class="indexterm"></a> service registration if Avahi or mDNSResponder were
            compiled in.</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.9.6"></a><h3>Miscellaneous Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">afp read locks = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to apply locks to the byte region read in FPRead
            calls. The AFP spec mandates this, but it's not really in line
            with UNIX semantics and is a performance hug.</p></dd><dt><span class="term">afpstats = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to provide AFP runtime statistics (connected users,
            open volumes) via dbus.</p></dd><dt><span class="term">basedir regex = <em class="replaceable"><code>regex</code></em>
          <span class="type">(H)</span></span></dt><dd><p>Regular expression which matches the parent directory of the
            user homes. If <code class="option">basedir regex</code> contains symlink,
            you must set the canonicalized absolute path. In the simple case
            this is just a path i.e. <code class="option">basedir regex =
            /home</code></p></dd><dt><span class="term">chmod request = <em class="replaceable"><code>preserve (default) | ignore |
          simple</code></em> <span class="type">(G)/(V)</span></span></dt><dd><p>Advanced permission control that deals with ACLs.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">ignore</code> - UNIX chmod() requests are
                completely ignored, use this option to allow the parent
                directory's ACL inheritance full control over new
                items.</p></li><li class="listitem"><p><code class="option">preserve</code> - preserve ZFS ACEs for named
                users and groups or POSIX ACL group mask</p></li><li class="listitem"><p><code class="option">simple</code> - just to a chmod() as requested
                without any extra steps</p></li></ul></div></dd><dt><span class="term">close vol = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to close volumes possibly opened by clients when
            they're removed from the configuration and the configuration is
            reloaded.</p></dd><dt><span class="term">cnid mysql host = <em class="replaceable"><code>MySQL server
          address</code></em> <span class="type">(G)</span></span></dt><dd><p>name or address of a MySQL server for use with the mysql
            CNID backend.</p></dd><dt><span class="term">cnid mysql user = <em class="replaceable"><code>MySQL user</code></em>
          <span class="type">(G)</span></span></dt><dd><p>MySQL user for authentication with the server.</p></dd><dt><span class="term">cnid mysql pw = <em class="replaceable"><code>password</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Password for MySQL server.</p></dd><dt><span class="term">cnid mysql db = <em class="replaceable"><code>database name</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Name of an existing database for which the specified user
            has full privileges.</p></dd><dt><span class="term">cnid server = <em class="replaceable"><code>ipaddress[:port]</code></em>
          <span class="type">(G)/(V)</span></span></dt><dd><p>Specifies the IP address and port of a cnid_metad server,
            required for CNID dbd backend. Defaults to localhost:4700. The
            network address may be specified either in dotted-decimal format
            for IPv4 or in hexadecimal format for IPv6.-</p></dd><dt><span class="term">dbus daemon = <em class="parameter"><code>path</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the path to dbus-daemon binary used by Spotlight
            feature. The default value
            <code class="filename">["/bin/dbus-daemon"]</code> is determined when
            building netatalk.</p></dd><dt><span class="term">dircachesize = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Maximum possible entries in the directory cache. The cache
            stores directories and files. It is used to cache the full path to
            directories and CNIDs which considerably speeds up directory
            enumeration.</p><p>Default size is 8192, maximum size is 131072. Given value is
            rounded up to nearest power of 2. Each entry takes about 100
            bytes, which is not much, but remember that every afpd child
            process for every connected user has its cache.</p></dd><dt><span class="term">extmap file = <em class="parameter"><code>path</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the path to the file which defines file extension
            type/creator mappings.</p></dd><dt><span class="term">force xattr with sticky bit =
          <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G/V)</span></span></dt><dd><p>Writing metadata xattr on directories with the sticky bit
            set may fail even though we may have write access to a directory,
            because if the sticky bit is set only the owner is allowed to
            write xattrs.</p><p>By enabling this option Netatalk will write the metadata
            xattr as root.</p></dd><dt><span class="term">guest account = <em class="replaceable"><code>name</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies the user that guests should use (default is
            nobody). The name must be a valid user on the host system.</p></dd><dt><span class="term">home name = <em class="replaceable"><code>name</code></em>
          <span class="type">(H)</span></span></dt><dd><p>AFP user home volume name. The default is <span class="emphasis"><em>$u's
            home</em></span>. The name must contain
            "<span class="emphasis"><em>$u</em></span>".</p></dd><dt><span class="term">ignored attributes = <em class="replaceable"><code>all | nowrite | nodelete |
          norename</code></em> <span class="type">(G)/(V)</span></span></dt><dd><p>Specify a set of file and directory attributes that shall be
            ignored by the server, <code class="option">all</code> includes all the other
            options.</p><p>In OS X when the Finder sets a lock on a file/directory or
            you set the BSD uchg flag in the Terminal, all three attributes
            are used. Thus in order to ignore the Finder lock/BSD uchg flag,
            add set <span class="emphasis"><em>ignored attributes = all</em></span>.</p></dd><dt><span class="term">legacy icon = <em class="replaceable"><code>icon</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the shared volume icon displayed in the Finder in
            Classic Mac OS. Default is to display an icon indicating the
            transport layer used (TCP/IP or AppleTalk). Examples of valid icon
            styles:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">daemon</code></p></li><li class="listitem"><p><code class="option">globe</code></p></li><li class="listitem"><p><code class="option">sdcard</code></p></li></ul></div></dd><dt><span class="term">login message = <em class="replaceable"><code>message</code></em>
          <span class="type">(G)/(V)</span></span></dt><dd><p>Sets a message to be displayed when clients logon to the
            server. The message should be in <code class="option">unix charset</code>.
            Extended characters are allowed.</p></dd><dt><span class="term">mimic model = <em class="replaceable"><code>model</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies a custom icon for the mounted AFP volume on macOS
            / Mac OS X clients. Default is to let macOS choose. Requires
            netatalk to be built with Zeroconf. Examples:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="option">Laptop</code></p></li><li class="listitem"><p><code class="option">RackMount</code></p></li><li class="listitem"><p><code class="option">Tower</code></p></li></ul></div><p>A complete set of supported model codes by a macOS client
            can be found by inspecting
            <code class="filename">/System/Library/CoreServices/CoreTypes.bundle/Contents/Info.plist
            </code> (as of macOS 14 Sonoma).</p></dd><dt><span class="term">signature = <em class="replaceable"><code>STRING</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specify a server signature. The maximum length is 16
            characters. This option is useful for clustered environments, to
            provide fault isolation etc. By default, afpd generates a
            signature and saves it to a file called
            <code class="filename">afp_signature.conf</code> automatically (based on
            random numbers). See also asip-status(1).</p></dd><dt><span class="term">solaris share reservations =
          <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Use share reservations on Solaris. Solaris CIFS server uses
            this too, so this makes a lock coherent multi protocol
            server.</p></dd><dt><span class="term">sparql results limit = <em class="replaceable"><code>NUMBER</code></em>
          (default: <span class="emphasis"><em>UNLIMITED</em></span>) <span class="type">(G)</span></span></dt><dd><p>Impose a limit on the number of results queried from Tracker
            or LocalSearch via SPARQL queries.</p></dd><dt><span class="term">spotlight = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)/(V)</span></span></dt><dd><p>Whether to enable Spotlight searches. Note: once the global
            option is enabled, any volume that is not enabled won't be
            searchable at all. See also <span class="emphasis"><em>dbus daemon</em></span>
            option.</p></dd><dt><span class="term">spotlight attributes = <em class="replaceable"><code>COMMA SEPARATED
          STRING</code></em> (default: <span class="emphasis"><em>EMPTY</em></span>)
          <span class="type">(G)</span></span></dt><dd><p>A list of attributes that are allowed to be used in
            Spotlight searches. By default all attributes can be searched,
            passing a string limits attributes to elements of the string.
            Example: </p><pre class="programlisting">spotlight attributes = *,kMDItemTextContent</pre></dd><dt><span class="term">spotlight expr = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to allow the use of logic expression in
            searches.</p></dd><dt><span class="term">start dbus = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to start a dbus instance for use with Tracker or
            LocalSearch.</p></dd><dt><span class="term">start tracker = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Whether to start Tracker or LocalSearch with
            "<span class="command"><strong>tracker daemon -s</strong></span>" or "<span class="command"><strong>localsearch
            daemon -s</strong></span>". In case of old Tracker,
            "<span class="command"><strong>tracker-control -s</strong></span>" is used instead.</p></dd><dt><span class="term">veto message = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Send optional AFP messages for vetoed files. Then whenever a
            client tries to access any file or directory with a vetoed name,
            it will be sent an AFP message indicating the name and the
            directory.</p></dd><dt><span class="term">vol dbpath = <em class="replaceable"><code>path</code></em>
          <span class="type">(G)/(V)</span></span></dt><dd><p>Sets the path where the database information will be stored.
            You have to specify a writable location, even if the volume is
            read only.</p></dd><dt><span class="term">vol dbnest = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>Setting this option to true brings back Netatalk 2 behaviour
            of storing the CNID database in a folder called .AppleDB inside
            the volume root of each share.</p></dd><dt><span class="term">volnamelen = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Max length of UTF8-MAC volume name for Mac OS X. Note that
            Hangul is especially sensitive to this.</p><pre class="programlisting">73: limit of Mac OS X 10.1
80: limit of Mac OS X 10.4/10.5 (default)
255: limit of recent Mac OS X</pre><p> Mac OS 9 and earlier are not
            influenced by this, because Maccharset volume name is always
            limited to 27 bytes.</p></dd><dt><span class="term">vol preset = <em class="replaceable"><code>name</code></em>
          <span class="type">(G)/(V)</span></span></dt><dd><p>Use section <code class="option">name</code> as option preset for all
            volumes (when set in the [Global] section) or for one volume (when
            set in that volume's section).</p></dd><dt><span class="term">zeroconf name = <em class="replaceable"><code>name</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies a human-readable name that uniquely describes
            registered services. The zeroconf name is advertised as UTF-8, up
            to 63 octets (bytes) in length. Defaults to hostname. Note that
            netatalk must support Zeroconf.</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.9.7"></a><h3>Logging Options</h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">log file = <em class="replaceable"><code>logfile</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Write logs to <code class="option">logfile</code> on the file system.
            If not specified, Netatalk logs to the syslog daemon
            facility.</p></dd><dt><span class="term">log level = <em class="replaceable"><code>type:level [type:level
          ...]</code></em> <span class="type">(G)</span>, </span><span class="term">log level = <em class="replaceable"><code>type:level,[type:level,
          ...]</code></em> <span class="type">(G)</span></span></dt><dd><p>Specify that any message of a loglevel up to the given
            <code class="option">log level</code> should be logged.</p><p>By default afpd logs to syslog with a default logging setup
            equivalent to <code class="option">default:note</code></p><p>logtypes: default, afpdaemon, logger, uamsdaemon</p><p>loglevels: severe, error, warn, note, info, debug, debug6,
            debug7, debug8, debug9, maxdebug</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>Both logtype and loglevels are case insensitive.</p></div></dd><dt><span class="term">log microseconds = <em class="replaceable"><code>BOOLEAN</code></em>
          (default: <span class="emphasis"><em>yes</em></span>) <span class="type">(G)</span></span></dt><dd><p>Log timestamps with accuracy down to microseconds. If
            disabled, the timestamps record only whole seconds. Only takes
            effect when used in tandem with the <code class="option">log file</code>
            option.</p></dd></dl></div></div><div class="refsect2"><a id="fceconf"></a><h3>Filesystem Change Events (FCE<a id="id-1.9.6.9.8.1.1" class="indexterm"></a>)</h3><p>Netatalk includes a nifty filesystem change event mechanism where
      afpd processes notify interested listeners about certain filesystem
      event by UDP network datagrams.</p><p>The following FCE events are defined:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>file modification (<code class="option">fmod</code>)</p></li><li class="listitem"><p>file deletion (<code class="option">fdel</code>)</p></li><li class="listitem"><p>directory deletion (<code class="option">ddel</code>)</p></li><li class="listitem"><p>file creation (<code class="option">fcre</code>)</p></li><li class="listitem"><p>directory creation (<code class="option">dcre</code>)</p></li><li class="listitem"><p>file move or rename (<code class="option">fmov</code>)</p></li><li class="listitem"><p>directory move or rename (<code class="option">dmov</code>)</p></li><li class="listitem"><p>login (<code class="option">login</code>)</p></li><li class="listitem"><p>logout (<code class="option">logout</code>)</p></li></ul></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">fce listener = <em class="replaceable"><code>host[:port]</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Enables sending FCE events to the specified
            <em class="parameter"><code>host</code></em>, default <em class="parameter"><code>port</code></em>
            is 12250 if not specified. Specifying multiple listeners is done
            by having this option once for each of them.</p></dd><dt><span class="term">fce version = <em class="replaceable"><code>1|2</code></em>
          <span class="type">(G)</span></span></dt><dd><p>FCE protocol version, default is 1. You need version 2 for
            the fmov, dmov, login or logout events.</p></dd><dt><span class="term">fce events =
          <em class="replaceable"><code>fmod,fdel,ddel,fcre,dcre,fmov,dmov,login,logout</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies which FCE events are active, default is
            <em class="parameter"><code>fmod,fdel,ddel,fcre,dcre</code></em>.</p></dd><dt><span class="term">fce coalesce = <em class="replaceable"><code>all|delete|create</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Coalesce FCE events.</p></dd><dt><span class="term">fce holdfmod = <em class="replaceable"><code>seconds</code></em>
          <span class="type">(G)</span></span></dt><dd><p>This determines the time delay in seconds which is always
            waited if another file modification for the same file is done by a
            client before sending an FCE file modification event (fmod). For
            example saving a file in Photoshop would generate multiple events
            by itself because the application is opening, modifying and
            closing a file multiple times for every "save". Default: 60
            seconds.</p></dd><dt><span class="term">fce sendwait = <em class="replaceable"><code>milliseconds</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Defines a delay in milliseconds between the emission of each
            FCE event. Use this if you are experiencing lost FCE events when
            creating or deleting a very large number of files at once. The
            deluge of events that such an operation triggers can lead to UDP
            buffer overflow and subsequently to packet loss. Has to be a
            number between 0 and 999. Default: 0 milliseconds.</p></dd><dt><span class="term">fce ignore names = <em class="replaceable"><code>NAME[/NAME2/...]</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Slash delimited list of filenames for which FCE events shall
            not be generated. Default: .DS_Store.</p></dd><dt><span class="term">fce ignore directories =
          <em class="replaceable"><code>NAME[,NAME2,...]</code></em> <span class="type">(G)</span></span></dt><dd><p>Comma delimited list of directories for which FCE events
            shall not be generated. Default: empty.</p></dd><dt><span class="term">fce notify script = <em class="replaceable"><code>PATH</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Script which will be executed for every FCE event, see
            contrib/shell_utils/fce_ev_script.sh from the Netatalk sources for
            an example script.</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.9.9"></a><h3>Debug Parameters</h3><p>These options are useful for debugging only.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">tickleval = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Sets the tickle timeout interval (in seconds). Defaults to
            30.</p></dd><dt><span class="term">timeout = <em class="replaceable"><code>number</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specify the number of tickles to send before timing out a
            connection. The default is 4, therefore a connection will timeout
            after 2 minutes.</p></dd><dt><span class="term">client polling = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(G)</span></span></dt><dd><p>With this option enabled, afpd won't advertise that it is
            capable of server notifications, so that connected clients poll
            the server every 10 seconds to detect changes in opened server
            windows. <span class="emphasis"><em>Note</em></span>: Depending on the number of
            simultaneously connected clients and the network's speed, this can
            lead to a significant higher load on your network!</p><p>Do not use this option any longer as present Netatalk
            correctly supports server notifications, allowing connected
            clients to update folder listings in case another client changed
            the contents.</p></dd></dl></div></div><div class="refsect2"><a id="acl_options"></a><h3>Options for ACL handling</h3><p>By default, the effective permission of the authenticated user are
      only mapped to the mentioned UARights permission structure, not the UNIX
      mode. You can adjust this behaviour with the configuration option
      <code class="option">map acls</code>:</p><div class="variablelist"><a id="map_acls"></a><dl class="variablelist"><dt><span class="term">map acls = <em class="parameter"><code>none|rights|mode</code></em>
          <span class="type">(G)</span></span></dt><dd><div class="variablelist"><dl class="variablelist"><dt><span class="term">none</span></dt><dd><p>no mapping of ACLs</p></dd><dt><span class="term">rights</span></dt><dd><p>effective permissions are mapped to UARights
                    structure. This is the default.</p></dd><dt><span class="term">mode</span></dt><dd><p>ACLs are additionally mapped to the UNIX mode of the
                    filesystem object.</p></dd></dl></div></dd></dl></div><p>If you want to be able to display ACLs on the client, you must
      setup both client and server as part on a authentication domain
      (directory service, e.g. LDAP, Open Directory, Active Directory). The
      reason is, in OS X ACLs are bound to UUIDs, not just uid's or gid's.
      Therefore Netatalk must be able to map every filesystem uid and gid to a
      UUID so that it can return the server side ACLs which are bound to UNIX
      uid and gid mapped to OS X UUIDs.</p><p>Netatalk can query a directory server using LDAP queries. Either
      the directory server already provides an UUID attribute for user and
      groups (Active Directory, Open Directory) or you reuse an unused
      attribute (or add a new one) to you directory server (eg
      OpenLDAP).</p><p>The following LDAP options must be configured for Netatalk:</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">ldap auth method = <em class="parameter"><code>none|simple|sasl</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Authentication method: <code class="option">none | simple |
            sasl</code></p><div class="variablelist"><dl class="variablelist"><dt><span class="term">none</span></dt><dd><p>anonymous LDAP bind</p></dd><dt><span class="term">simple</span></dt><dd><p>simple LDAP bind</p></dd><dt><span class="term">sasl</span></dt><dd><p>SASL. Not yet supported !</p></dd></dl></div></dd><dt><span class="term">ldap auth dn = <em class="parameter"><code>dn</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Distinguished Name of the user for simple bind.</p></dd><dt><span class="term">ldap auth pw = <em class="parameter"><code>password</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Password for simple bind.</p></dd><dt><span class="term">ldap uri = <em class="parameter"><code>ldap://somehost:1234/</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Specifies the LDAP URI of the server to connect to. The URI
            scheme may be ldap, ldapi or ldaps, specifying LDAP over TCP, ICP
            or TLS respectively (if supported by the LDAP library). This is
            only needed for explicit ACL support in order to be able to query
            LDAP for UUIDs.</p><p>You can use <span class="citerefentry"><span class="refentrytitle">afpldaptest</span>(1)</span> to syntactically check your config.</p></dd><dt><span class="term">ldap userbase = <em class="parameter"><code>base dn</code></em>
          <span class="type">(G)</span></span></dt><dd><p>DN of the user container in LDAP.</p></dd><dt><span class="term">ldap userscope = <em class="parameter"><code>scope</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Search scope for user search: <code class="option">base | one |
            sub</code></p></dd><dt><span class="term">ldap groupbase = <em class="parameter"><code>base dn</code></em>
          <span class="type">(G)</span></span></dt><dd><p>DN of the group container in LDAP.</p></dd><dt><span class="term">ldap groupscope = <em class="parameter"><code>scope</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Search scope for group search: <code class="option">base | one |
            sub</code></p></dd><dt><span class="term">ldap uuid attr = <em class="parameter"><code>dn</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Name of the LDAP attribute with the UUIDs.</p><p>Note: this is used both for users and groups.</p></dd><dt><span class="term">ldap name attr = <em class="parameter"><code>dn</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Name of the LDAP attribute with the users short name.</p></dd><dt><span class="term">ldap group attr = <em class="parameter"><code>dn</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Name of the LDAP attribute with the groups short
            name.</p></dd><dt><span class="term">ldap uuid string = <em class="parameter"><code>STRING</code></em>
          <span class="type">(G)</span></span></dt><dd><p>Format of the uuid string in the directory. A series of x
            and -, where every x denotes a value 0-9a-f and every - is a
            separator.</p><p>Default: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx</p></dd><dt><span class="term">ldap uuid encoding = <em class="parameter"><code>string | ms-guid (default:
          string)</code></em> <span class="type">(G)</span></span></dt><dd><p>Format of the UUID of the LDAP attribute, allows usage of
            the binary objectGUID fields from Active Directory. If left
            unspecified, string is the default, which passes through the ASCII
            UUID returned by most other LDAP stores. If set to ms-guid, the
            internal UUID representation is converted to and from the binary
            format used in the objectGUID attribute found on objects in Active
            Directory when interacting with the server.</p><p>See also the options <code class="option">ldap user filter</code> and
            <code class="option">ldap group filter</code>.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">string</span></dt><dd><p>UUID is a string, use with e.g.
                    OpenDirectory.</p></dd><dt><span class="term">ms-guid</span></dt><dd><p>Binary objectGUID from Active Directory</p></dd></dl></div></dd><dt><span class="term">ldap user filter = <em class="parameter"><code>STRING (default:
          unused)</code></em> <span class="type">(G)</span></span></dt><dd><p>Optional LDAP filter that matches user objects. This is
            necessary for Active Directory environments where users and groups
            are stored in the same directory subtree.</p><p>Recommended setting for Active Directory:
            <em class="parameter"><code>objectClass=user</code></em>.</p></dd><dt><span class="term">ldap group filter = <em class="parameter"><code>STRING (default:
          unused)</code></em> <span class="type">(G)</span></span></dt><dd><p>Optional LDAP filter that matches group objects. This is
            necessary for Active Directory environments where users and groups
            are stored in the same directory subtree.</p><p>Recommended setting for Active Directory:
            <em class="parameter"><code>objectClass=group</code></em>.</p></dd></dl></div></div></div><div class="refsect1"><a id="id-1.9.6.10"></a><h2>Explanation of Volume Parameters</h2><div class="refsect2"><a id="id-1.9.6.10.2"></a><h3>Parameters</h3><p>The section name defines the volume name. No two volumes may have
      the same name. The volume name cannot contain the <span class="keycode">':'</span>
      character. The volume name is mangled if it is very long. Mac charset
      volume name is limited to 27 characters. UTF8-MAC volume name is limited
      to volnamelen parameter.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">path = <em class="replaceable"><code>PATH</code></em> <span class="type">(V)</span></span></dt><dd><p>The path name must be a fully qualified path name.</p></dd><dt><span class="term">appledouble = <em class="replaceable"><code>ea|v2</code></em>
          <span class="type">(V)</span></span></dt><dd><p>Specify the format of the metadata files, which are used for
            saving Mac resource fork as well. Earlier versions used
            AppleDouble v2, the new default format is <span class="bold"><strong>ea</strong></span>.</p></dd><dt><span class="term">vol size limit = <em class="replaceable"><code>size in MiB</code></em>
          <span class="type">(V)</span></span></dt><dd><p>Useful for Time Machine: limits the reported volume size,
            thus preventing Time Machine from using the whole real disk space
            for backup. Example: "vol size limit = 1000" would limit the
            reported disk space to 1 GB. <span class="bold"><strong>IMPORTANT:
            </strong></span> This is an approximated calculation taking into
            account the contents of Time Machine sparsebundle images.
            Therefore you MUST NOT use this volume to store other content when
            using this option, because it would NOT be accounted for. The
            calculation works by reading the band size from the Info.plist XML
            file of the sparsebundle, reading the bands/ directory counting
            the number of band files, and then multiplying one with the
            other.</p></dd><dt><span class="term">valid users = <em class="replaceable"><code>user @group</code></em>
          <span class="type">(V)</span></span></dt><dd><p>The allow option allows the users and groups that access a
            share to be specified. Users and groups are specified, delimited
            by spaces or commas. Groups are designated by a @ prefix. Example:
            </p><pre class="programlisting">valid users = user @group</pre></dd><dt><span class="term">invalid users = <em class="replaceable"><code>users/groups</code></em>
          <span class="type">(V)</span></span></dt><dd><p>The deny option specifies users and groups who are not
            allowed access to the share. It follows the same format as the
            "valid users" option.</p></dd><dt><span class="term">hosts allow = <em class="replaceable"><code>IP host address/IP netmask bits [
          ... ]</code></em> <span class="type">(V)</span></span></dt><dd><p>Only listed hosts and networks are allowed, all others are
            rejected. The network address may be specified either in
            dotted-decimal format for IPv4 or in hexadecimal format for
            IPv6.</p><p>Example: hosts allow = 10.1.0.0/16 10.2.1.100
            2001:0db8:1234::/48</p></dd><dt><span class="term">hosts deny = <em class="replaceable"><code>IP host address/IP netmask bits [
          ... ]</code></em> <span class="type">(V)</span></span></dt><dd><p>Listed hosts and nets are rejected, all others are
            allowed.</p><p>Example: hosts deny = 192.168.100/24 10.1.1.1
            2001:db8::1428:57ab</p></dd><dt><span class="term">cnid scheme = <em class="replaceable"><code>backend</code></em>
          <span class="type">(V)</span></span></dt><dd><p>set the CNID backend to be used for the volume, default is
            ["dbd"] available schemes:
            ["dbd last mysql"]</p></dd><dt><span class="term">ea = <em class="replaceable"><code>none|auto|sys|ad|samba</code></em>
          <span class="type">(V)</span></span></dt><dd><p>Specify how Extended Attributes<a id="id-1.9.6.10.2.3.9.2.1.1" class="indexterm"></a> are stored. <code class="option">auto</code> is the
            default.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">auto</span></dt><dd><p>Try <code class="option">sys</code> (by setting an EA on the
                  shared directory itself), fallback to <code class="option">ad</code>.
                  Requires writable volume for performing test. "<code class="option">read
                  only = yes</code>" overwrites <code class="option">auto</code> with
                  <code class="option">none</code>. Use explicit "<code class="option">ea =
                  sys|ad</code>" for read-only volumes where
                  appropriate.</p></dd><dt><span class="term">sys</span></dt><dd><p>Use filesystem Extended Attributes.</p></dd><dt><span class="term">samba</span></dt><dd><p>Use filesystem Extended Attributes, but append a 0
                  byte to each xattr in order to be compatible with Samba's
                  vfs_streams_xattr.</p></dd><dt><span class="term">ad</span></dt><dd><p>Use files in <span class="emphasis"><em>.AppleDouble</em></span>
                  directories.</p></dd><dt><span class="term">none</span></dt><dd><p>No Extended Attributes support.</p></dd></dl></div><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>The <span class="bold"><strong>samba</strong></span> option should
              not be used on a volume that was previously set to <span class="bold"><strong>sys</strong></span>. This may lead data loss.</p></div></dd><dt><span class="term">mac charset = <em class="replaceable"><code>CHARSET</code></em>
          <span class="type">(V)</span></span></dt><dd><p>specifies the Mac client charset for this Volume, e.g.
            <span class="emphasis"><em>MAC_ROMAN</em></span>, <span class="emphasis"><em>MAC_CYRILLIC</em></span>.
            If not specified the global setting is applied. This setting is
            only required if you need volumes, where the Mac charset differs
            from the one globally set in the [Global] section.</p></dd><dt><span class="term">casefold = <code class="option">option</code> <span class="type">(V)</span></span></dt><dd><p>The casefold option handles, if the case of filenames should
            be changed. The available options are:</p><p><code class="option">tolower</code> - Lowercases names in both
            directions.</p><p><code class="option">toupper</code> - Uppercases names in both
            directions.</p><p><code class="option">xlatelower</code> - Client sees lowercase, server
            sees uppercase.</p><p><code class="option">xlateupper</code> - Client sees uppercase, server
            sees lowercase.</p></dd><dt><span class="term">password = <em class="replaceable"><code>password</code></em>
          <span class="type">(V)</span></span></dt><dd><p>This option allows you to set a volume password, which can
            be a maximum of 8 characters long (using ASCII strongly
            recommended at the time of this writing).</p></dd><dt><span class="term">file perm = <em class="replaceable"><code>mode</code></em>
          <span class="type">(V)</span>, </span><span class="term">directory perm = <em class="replaceable"><code>mode</code></em>
          <span class="type">(V)</span></span></dt><dd><p>Add(or) with the client requested permissions: <code class="option">file
            perm</code> is for files only, <code class="option">directory perm</code>
            is for directories only. Don't use with "<code class="option">unix priv =
            no</code>".</p><div class="example"><a id="id-1.9.6.10.2.3.13.3.2"></a><p class="title"><strong>Example 6.1. Volume for a collaborative workgroup</strong></p><div class="example-contents"><pre class="programlisting">file perm = 0660 directory perm =
              0770</pre></div></div><br class="example-break" /></dd><dt><span class="term">umask = <em class="replaceable"><code>mode</code></em>
          <span class="type">(V)</span></span></dt><dd><p>set perm mask. Don't use with "<code class="option">unix priv =
            no</code>".</p></dd><dt><span class="term">preexec = <em class="replaceable"><code>command</code></em>
          <span class="type">(V)</span></span></dt><dd><p>command to be run when the volume is mounted</p></dd><dt><span class="term">postexec = <em class="replaceable"><code>command</code></em>
          <span class="type">(V)</span></span></dt><dd><p>command to be run when the volume is closed</p></dd><dt><span class="term">root preexec = <em class="replaceable"><code>command</code></em>
          <span class="type">(V)</span></span></dt><dd><p>command to be run as root when the volume is mounted</p></dd><dt><span class="term">root postexec = <em class="replaceable"><code>command</code></em>
          <span class="type">(V)</span></span></dt><dd><p>command to be run as root when the volume is closed</p></dd><dt><span class="term">rolist = <code class="option">users/groups</code> <span class="type">(V)</span></span></dt><dd><p>Allows certain users and groups to have read-only access to
            a share. This follows the allow option format.</p></dd><dt><span class="term">rwlist = <em class="replaceable"><code>users/groups</code></em>
          <span class="type">(V)</span></span></dt><dd><p>Allows certain users and groups to have read/write access to
            a share. This follows the allow option format.</p></dd><dt><span class="term">veto files = <em class="replaceable"><code>vetoed names</code></em>
          <span class="type">(V)</span></span></dt><dd><p>hide files and directories,where the path matches one of the
            '/' delimited vetoed names. The veto string must always be
            terminated with a '/', e.g. "veto files = veto1/", "veto files =
            veto1/veto2/".</p></dd></dl></div></div><div class="refsect2"><a id="id-1.9.6.10.3"></a><h3>Volume options</h3><p>Boolean volume options.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">acls = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether to flag volumes as supporting ACLs. If ACL support
            is compiled in, this is yes by default.</p></dd><dt><span class="term">case sensitive = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether to flag volumes as supporting case-sensitive
            filenames. If the filesystem is case-insensitive, set to no.
            However, it is not fully verified.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In spite of being case sensitive as a matter of fact,
              netatalk 3.1.3 and earlier did not notify kCaseSensitive flag to
              the client. Starting with 3.1.4, it is notified correctly by
              default.</p></div></dd><dt><span class="term">cnid dev = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether to use the device number in the CNID backends. Helps
            when the device number is not constant across a reboot, e.g.
            cluster, ...</p></dd><dt><span class="term">convert appledouble = <em class="replaceable"><code>BOOLEAN</code></em>
          (default: <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether automatic conversion from <code class="option">appledouble =
            v2</code> to <code class="option">appledouble = ea</code> is performed when
            accessing filesystems from clients. This is generally useful, but
            costs some performance. It's recommendable to run
            <span class="command"><strong>dbd</strong></span> on volumes and do the conversion with that.
            Then this option can be set to no.</p></dd><dt><span class="term">delete veto files = <em class="replaceable"><code>BOOLEAN</code></em>
          (default: <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>This option is used when Netatalk is attempting to delete a
            directory that contains one or more vetoed files or directories
            (see the veto files option). If this option is set to no (the
            default) then if a directory contains any non-vetoed files or
            directories then the directory delete will fail. This is usually
            what you want.</p><p>If this option is set to yes, then Netatalk will attempt to
            recursively delete any files and directories within the vetoed
            directory.</p></dd><dt><span class="term">follow symlinks = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>The default setting is false thus symlinks are not followed
            on the server. This is the same behaviour as OS X's AFP server.
            Setting the option to true causes afpd to follow symlinks on the
            server. symlinks may point outside of the AFP volume, currently
            afpd doesn't do any checks for "wide symlinks".</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>This option will subtly break when the symlinks point
              across filesystem boundaries.</p></div></dd><dt><span class="term">invisible dots = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>make dot files invisible. WARNING: enabling this option will
            lead to unwanted sideeffects were OS X applications when saving
            files to a temporary file starting with a dot first, then renaming
            the temp file to its final name, result in the saved file being
            invisible. The only thing this option is useful for is making
            files that start with a dot invisible on Mac OS 9. It's completely
            useless on Mac OS X, as both in Finder and in Terminal files
            starting with a dot are hidden anyway.</p></dd><dt><span class="term">legacy volume size = <em class="replaceable"><code>BOOLEAN</code></em>
          (default: <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>Limit disk size reporting to 2GB for legacy clients. This
            can be used for older Macintoshes running System 7.1 or earlier
            and using newer AppleShare clients.</p></dd><dt><span class="term">network ids = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether the server support network ids. Setting this to
            <span class="emphasis"><em>no</em></span> will result in the client not using ACL
            AFP functions.</p></dd><dt><span class="term">preexec close = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>A non-zero return code from preexec close the volume being
            immediately, preventing clients to mount/see the volume in
            question.</p></dd><dt><span class="term">prodos = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>Enable ProDOS support. This option should only be enabled
            for volumes you expect to netboot an Apple II from. In addition to
            setting the boot flag on the volume, it restricts the volume free
            space shown to 32MB.</p></dd><dt><span class="term">read only = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>Specifies the share as being read only for all users.
            Overwrites <code class="option">ea = auto</code> with <code class="option">ea =
            none</code></p></dd><dt><span class="term">root preexec close= <em class="replaceable"><code>BOOLEAN</code></em>
          (default: <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>A non-zero return code from root_preexec closes the volume
            immediately, preventing clients to mount/see the volume in
            question.</p></dd><dt><span class="term">search db = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>Use fast CNID database namesearch instead of slow recursive
            filesystem search. Relies on a consistent CNID database, i.e.
            Samba or local filesystem access lead to inaccurate or wrong
            results. Works only for "dbd" CNID db volumes.</p></dd><dt><span class="term">stat vol = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether to stat volume path when enumerating volumes list,
            useful for automounting or volumes created by a preexec
            script.</p></dd><dt><span class="term">time machine = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>no</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether to enable Time Machine support for this
            volume.</p></dd><dt><span class="term">unix priv = <em class="replaceable"><code>BOOLEAN</code></em> (default:
          <span class="emphasis"><em>yes</em></span>) <span class="type">(V)</span></span></dt><dd><p>Whether to use AFP3 UNIX privileges. This should be set for
            OS X clients. See also: <code class="option">file perm</code>,
            <code class="option">directory perm</code> and <code class="option">umask</code>.</p></dd></dl></div></div></div><div class="refsect1"><a id="id-1.9.6.11"></a><h2>CNID backends</h2><p>The AFP protocol primarily refers to files and directories by ID and
    not by name. Netatalk needs a way to store these IDs in a persistent way.
    To achieve this, Netatalk provides multiple CNID backends with different
    capabilities. The CNID databases are by default located under
    localstatedir.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">dbd</span></dt><dd><p>Access to the CNID database is restricted to the
          <span class="command"><strong>cnid_metad</strong></span> daemon process.
          <span class="command"><strong>afpd</strong></span> processes communicate with the daemon for
          database reads and updates. If built with Berkeley DB transactions
          the probability for database corruption is practically zero, but
          performance can be slower than with <code class="option">cdb</code></p></dd><dt><span class="term">last</span></dt><dd><p>This backend is an exception, in terms of ID persistency. ID's
          are only valid for the current session. This is basically what
          <span class="command"><strong>afpd</strong></span> did in the 1.5 (and 1.6) versions. This
          backend is still available, as it is useful for e.g. sharing cdroms.
          Starting with Netatalk 3.0, it becomes the <span class="emphasis"><em>read only
          mode</em></span> automatically.</p><p><span class="bold"><strong>Warning</strong></span>: It is
          <span class="emphasis"><em>NOT</em></span> recommended to use this backend for volumes
          anymore, as <span class="command"><strong>afpd</strong></span> now relies heavily on a
          persistent ID database. Aliases will likely not work and filename
          mangling is not supported.</p></dd></dl></div><p>Even though <span class="command"><strong>./configure --help</strong></span> might show that
    there are other CNID backends available, be warned those are likely broken
    or mainly used for testing. Don't use them unless you know what you're
    doing, they may be removed without further notice from future
    versions.</p></div><div class="refsect1"><a id="id-1.9.6.12"></a><h2>Charset options</h2><p>With OS X Apple introduced the AFP3 protocol. One of the most
    important changes was that AFP3 uses unicode names encoded as UTF-8
    decomposed. Previous AFP/OS versions used codepages, like MacRoman,
    MacCentralEurope, etc.</p><p><span class="command"><strong>afpd</strong></span> needs a way to preserve extended Macintosh
    characters, or characters illegal in unix filenames, when saving files on
    a unix filesystem. This version now uses UTF-8 as the default encoding for
    names. '<span class="keycode">/</span>' will be converted to
    '<span class="keycode">:</span>'.</p><p>Earlier versions used the the so called CAP encoding. An extended
    character (&gt;0x7F) would be converted to a :xx sequence, e.g. the Apple
    Logo (MacRoman: 0xF0) was saved as <code class="literal">:f0</code>. Some special
    characters would be converted as to :xx notation as well.
    '<span class="keycode">/</span>' would be encoded to <code class="literal">:2f</code>, a
    leading dot '<span class="keycode">.</span>' might be encoded as
    <code class="literal">:2e</code>.</p><p>The <code class="option">vol charset</code> option will allow you to select
    another volume encoding. <span class="command"><strong>afpd</strong></span> will accept any
    <span class="citerefentry"><span class="refentrytitle"><span class="command"><strong>iconv</strong></span></span>(1)</span> provided charset. It is highly recommended to stick to
    the default UTF-8.</p></div><div class="refsect1"><a id="id-1.9.6.13"></a><h2>See Also</h2><p><span class="citerefentry"><span class="refentrytitle">afpd</span>(8)</span>, <span class="citerefentry"><span class="refentrytitle">afppasswd</span>(5)</span>, <span class="citerefentry"><span class="refentrytitle">afp_signature.conf</span>(5)</span>, <span class="citerefentry"><span class="refentrytitle">extmap.conf</span>(5)</span>, <span class="citerefentry"><span class="refentrytitle">cnid_metad</span>(8)</span></p></div><div class="refsect1"><a id="id-1.9.6.14"></a><h2>Author</h2><p>See <a class="ulink" href="https://github.com/Netatalk/netatalk/blob/main/CONTRIBUTORS" target="_top">CONTRIBUTORS</a></p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="aecho.1.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="man-pages.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="afp_signature.conf.5.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">aecho </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> afp_signature.conf</td></tr></table></div></body>
</html>
