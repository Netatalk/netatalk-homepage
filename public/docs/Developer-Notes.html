<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Netatalk Wiki - Developer Notes</title>
    <meta name="description" content="Netatalk Wiki">
    <link rel="canonical" href="https://netatalk.io/docs/Developer-Notes">
    <link rel="stylesheet" type="text/css" href="https://netatalk.io/css/site.css" />
    <link rel="icon" type="image/x-icon" href="https://netatalk.io/gfx/favicon.ico" />
</head>
<body>
<div id="header">
    <div id="logo"></div>
    <div id="menlinks">
        <a href="/" title="Return to Netatalk home">[main]</a>
        <a href="/docs" title="Netatalk Wiki">[wiki]</a>
        <a href="/documentation.html" title="Netatalk Manual">[documentation]</a>
        <a href="/download.html" title="Download Netatalk">[downloads]</a>
        <a href="/support.html" title="Support">[support]</a>
        <a href="/links.html" title="Netatalk related links">[links]</a>
        <img src="/gfx/end.gif" alt="" width="125" height="7" />
    </div>
</div>

<div id="header-print">
    <h1>netatalk.io</h1>
</div>

<div class="search">
    <h2>search netatalk.io</h2>
    <form method="get" action="https://www.google.com/search">
        <p>
            <input type="text" name="q" size="10" maxlength="255" value="" title="enter search text" />
            <input type="hidden" name="sitesearch" value="netatalk.io" />
            <input type="submit" name="btnG" value="Go" title="search netatalk.io" />
        </p>
    </form>
    <span class="italic">powered by Google</span>
</div>

<div id="navbars">
<div class="navbar">
<h2>Table of contents</h2>
<p>Resources</p>
<ul>
<li><a class="wikilink" href="/docs/FAQ.html">FAQ</a></li>
<li><a class="wikilink" href="/docs/Troubleshooting.html">Troubleshooting</a></li>
<li><a class="wikilink" href="/docs/Connect-to-AFP-Server.html">Connect to AFP Server</a></li>
<li><a class="wikilink" href="/docs/Webmin-Module.html">Webmin Module</a></li>
<li><a class="wikilink" href="/docs/Benchmarks.html">Benchmarks</a></li>
</ul>
<p>Netatalk v3 Installation</p>
<ul>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-Fedora-Linux.html">Installing Netatalk 3 on Fedora Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-FreeBSD.html">Installing Netatalk 3 on FreeBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-macOS.html">Installing Netatalk 3 on macOS</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-OpenBSD.html">Installing Netatalk 3 on OpenBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-OpenIndiana.html">Installing Netatalk 3 on OpenIndiana</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-openSUSE.html">Installing Netatalk 3 on openSUSE</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-Solaris.html">Installing Netatalk 3 on Solaris</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-Ubuntu.html">Installing Netatalk 3 on Ubuntu</a></li>
</ul>
<p>Netatalk v2 Installation</p>
<ul>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-Alpine-Linux.html">Installing Netatalk 2 on Alpine Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-Debian-Linux.html">Installing Netatalk 2 on Debian Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-Fedora-Linux.html">Installing Netatalk 2 on Fedora Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-macOS.html">Installing Netatalk 2 on macOS</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-NetBSD.html">Installing Netatalk 2 on NetBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-OmniOS.html">Installing Netatalk 2 on OmniOS</a></li>
</ul>
<p>Technical Docs</p>
<ul>
<li><a class="wikilink" href="/docs/CatalogSearch.html">CatalogSearch</a></li>
<li><a class="wikilink" href="/docs/Kerberos.html">Kerberos</a></li>
<li><a class="wikilink" href="/docs/Special-Files-and-Folders.html">Special Files and Folders</a></li>
<li><a class="wikilink" href="/docs/Spotlight.html">Spotlight</a></li>
<li><a class="wikilink" href="/docs/AppleTalk-Kernel-Module.html">AppleTalk Kernel Module</a></li>
<li><a class="wikilink" href="/docs/Print-Server.html">Print Server</a></li>
</ul>
<p>Development</p>
<ul>
<li><a class="wikilink" href="/docs/Developer-Notes.html">Developer Notes</a></li>
<li><a class="wikilink" href="/docs/Developer-FAQ.html">Developer FAQ</a></li>
<li><a class="wikilink" href="/docs/Work-with-Documentation.html">Work with Documentation</a></li>
<li><a class="wikilink" href="/docs/Release-Process.html">Release Process</a></li>
<li><a class="wikilink" href="/docs/Using-GDB-to-Analyze-a-Crash.html">Using GDB to Analyze a Crash</a></li>
</ul>
</div></div>
<div id="content">
<h1 id="Developer-Notes">Developer Notes</h1><hr/>
<h1>How to Contribute</h1>
<p>Netatalk source code is hosted in a shared git repository.</p>
<p>This section describes the general workflow and lifecycle of code
contributions in the Netatalk Project, and how to get new code accepted
into release branches. It is applicable to Netatalk Team members and
external contributors alike. Please read this thoroughly and familiarize
yourself with the process before submitting code to the project.</p>
<h2>Git Installation</h2>
<p>If you haven&rsquo;t used git before, you should probably familiarize yourself
with the <a href="http://www.kernel.org/pub/software/scm/git/docs/gittutorial.html">Git
tutorial</a>.</p>
<p>The examples in the following sections are based off of the tools and
syntax used by git v1.5.3 or later. Either apt-get, yum, or make install
the tools. See <a href="http://www.kernel.org/pub/software/scm/git/">Git
documentation</a> for more
details on this part.</p>
<h2>Branching model</h2>
<ul>
<li>The <code>main</code> branch is where development of new features is taking place.</li>
<li>Branches named <code>branch-netatalk-x-y</code> are for stable releases.</li>
<li>Make your code changes in a feature branch, and submit a Pull Request against the target branch.</li>
<li>Before submitting PRs against stable branches, please make sure an issue report has been filed first.</li>
<li>When patching stable branches, prioritize submitting PRs for those stable branches. The patches can be cherry-picked to <code>main</code> by a maintainer later.</li>
<li>The issue report must be referenced in the commit message.</li>
<li>We allow rebase merges only; no branch merges.</li>
</ul>
<h2>Review process</h2>
<p>We require formal review of all patches with more than trivial code
changes.</p>
<p>The author of patch should add a signed-off tag and the reviewer adds a
reviewed-by tag. Very formal, but it encourages better coding and
documentation.</p>
<p>This means every commit in main should have been reviewed by two team
members (if the author is a team member, only one review by another team
member needed).</p>
<p>This is inspired by the process used in the
<a href="https://wiki.samba.org/index.php/CodeReview">Samba</a> project.</p>
<h2>Commit messages</h2>
<p>Commit messages should have a short, descriptive first summary line that
begins with the affected component, and ends with the GitHub issue
ticket # e.g.</p>
<blockquote>
<p>afpd: new options &ldquo;force user&rdquo; and &ldquo;force group&rdquo;, GitHub #1234</p>
</blockquote>
<p>This is helpful when browsing a git log in oneline mode.</p>
<p>Then the commit message should explain what the change is about, the
more, the better.</p>
<p>At the end the author adds their signed-off tag.</p>
<h2>Basic Netatalk Git</h2>
<p>The mother git repository is located at
<code>https://github.com/Netatalk/netatalk.git</code></p>
<p>If you are a Netatalk team member, you create and push work branches
directly in the mother repository.</p>
<p>If you are an non-member code contributor (thank you for volunteering!)
then work from your own fork of the Netatalk repository. Please follow
the <a href="https://docs.github.com/en/get-started/quickstart/fork-a-repo">GitHub workflow to create your
fork</a>,
and then clone that fork in the steps below.</p>
<p>Step Zero is to set your name and email address for commits: </p>
<pre><code>$ git config --global user.email Your.Email@domain.com
$ git config --global user.name &quot;Your Real Name&quot;
</code></pre>
<p>Next, clone the repository: </p>
<pre><code>$ git clone https://github.com/Netatalk/netatalk.git 
Initialized empty Git repository in /home/frank/test/.git/
remote: Counting objects: 31503, done.
remote: Compressing objects: 100% (11427/11427), done.
remote: Total 31503 (delta 24830), reused 25450 (delta 19869)
Receiving objects: 100% (31503/31503), 6.52 MiB | 2.38 MiB/s, done.
Resolving deltas: 100% (24830/24830), done.
$ cd netatalk
</code></pre>
<p>List local and remote branches: </p>
<pre><code>$ git branch
  * main

$ git branch -r
origin/branch-netatalk-2-0
origin/branch-netatalk-2-1
origin/branch-netatalk-2-2
origin/branch-netatalk-3-0
origin/branch-netatalk-3-1
origin/main
</code></pre>
<p>Creating your own working branch from main:</p>
<pre><code>$ git checkout main
$ git checkout -b my_branch
Branch my_branch set up to track remote branch refs/remotes/origin/develop.
Switched to a new branch &quot;my_branch&quot;
</code></pre>
<p>Do your own local work:</p>
<pre><code>$ mkdir git-test
$ echo &quot;hello&quot; &gt; git-test/README
</code></pre>
<p>View status of changes</p>
<pre><code>$ git status
# On branch my_branch
# Untracked files:
#   (use &quot;git add `&lt;file&gt;`...&quot; to include in what will be committed)
# 
#       git-test/
nothing added to commit but untracked files present (use &quot;git add&quot; to track)
</code></pre>
<p>Add our new file to the local branch index:</p>
<pre><code>$ git add git-test
$ git status
# On branch my_branch
# Changes to be committed:
#   (use &quot;git reset HEAD `&lt;file&gt;`...&quot; to unstage)
#
#       new file:   git-test/README
#
</code></pre>
<p>Commit changes </p>
<pre><code>$ git commit -m &quot;Example file for HOWTO&quot;
Created commit ad9a1eb: Example file for HOWTO
 1 files changed, 1 insertions(+), 0 deletions(-)
 create mode 100644 git-test/README
</code></pre>
<p>Do some more work and commit local changes....</p>
<p>Now fetch the remote branch history: </p>
<pre><code>$ git fetch
</code></pre>
<p>To present your patchset properly to other developers, please rebase
your patches against the branch you are developing against: </p>
<pre><code>$ git rebase origin/main
</code></pre>
<p>Obviously, replace &ldquo;origin/main&rdquo; by whatever branch you are
developing against. If you have created a mess in your local patch
queue, &ldquo;git rebase -i&rdquo; might help you out.</p>
<h2>Pull Requests</h2>
<p>All new code must go through the GitHub Pull Request workflow, which
involves at least one project member doing code review and signing off
on it, before merging to the target branch.</p>
<p>The description of the workflow can be read in <a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/proposing-changes-to-your-work-with-pull-requests/about-pull-requests">GitHub
documentation</a>
and will not be repeated here.</p>
<p>The title of the PR should be descriptive and fit on one line. It should <em>not</em> contain the GitHub ticket number.
When it is a PR against a <em>stable branch</em>, prepend a tag with the major and minor Netatalk version.
For PRs against the <strong>main</strong> development branch, do not prepend any tags.</p>
<p>A good example:</p>
<blockquote>
<p>[3.2] meson: Allow choosing shared or static libraries to build</p>
</blockquote>
<p>In the PR summary, make sure you add a description of the purpose of the PR,
with a breakdown of the major changes that it is making.</p>
<p>The PR reviewers will be automatically assigned based on the CODEOWNERS settings,
so sit back and relax while a project member follows up!</p>
<h2>Build system</h2>
<p>In the stable netatalk release 3.2.0 (and 2.4.0) we introduced the <a href="https://mesonbuild.com/">Meson build system</a>, initially in addition to the traditional GNU autotools build system, but eventually as a full replacement.</p>
<p>Meson is faster at building the netatalk source code by an order of magnitude. Additionally, it allows us in the development team to work more effectively to fix bugs and add functionality. And finally, it removes the need to &ldquo;bootstrap&rdquo; the build system which introduces thousands of lines of boilerplate macros.</p>
<p>See the <a href="https://github.com/Netatalk/netatalk/blob/main/INSTALL">INSTALL</a> file in the netatalk code tree for more details on how to use the Meson build system.</p>
<h3>Formatting</h3>
<p>We use <code>muon fmt</code> to format all the meson.build files as it applies the meson syntax recommendations to all files.
<a href="https://github.com/annacrombie/muon">Muon</a> is an independent implementation of Meson that comes with a powerful formatter.</p>
<p>Install muon and save the following script as &lsquo;muonfmt&rsquo; in your local bin directory (chmod +x it too):</p>
<pre><code>#!/bin/bash

find . -type f -name &quot;meson.build&quot; -exec muon fmt -i {} \;
</code></pre>
<p>Then all you need to do is:</p>
<pre><code>cd netatalk
muonfmt
</code></pre>
<p><em>Note:</em> In Debian, the muon package and binary are called <code>muon-meson</code>.</p>
<h2>Links to Developer Resources</h2>
<ul>
<li><a href="https://developer.apple.com/library/mac/#documentation/Networking/Conceptual/AFP/Introduction/Introduction.html">AFP Programming
    Guide</a></li>
<li><a href="https://web.archive.org/web/20130906023421/https://developer.apple.com/library/mac/documentation/Networking/Reference/AFP_Reference/Reference/reference.html">AFP Reference
    Guide</a></li>
<li><a href="http://developer.apple.com/legacy/mac/library/documentation/mac/toolbox/Toolbox-463.html">Inside Macintosh: Macintosh Toolbox Essentials Chapter 7 - Finder
    Interface</a></li>
<li><a href="https://archive.org/details/inside-appletalk/page/n201/mode/2up">Inside AppleTalk: AppleTalk Filing Protocol v1.1</a></li>
<li><a href="https://web.archive.org/web/20100317155553/http://developer.apple.com/legacy/mac/library/documentation/Carbon/Reference/Finder_Interface/Reference/reference.html">Finder Interface
    Reference</a></li>
<li><a href="http://developer.apple.com/mac/library/technotes/tn/tn1150.html#FinderInfo">Technical Note TN1150 HFS Plus Volume
    Format</a></li>
<li><a href="https://web.archive.org/web/20130929082911/http://www.opensource.apple.com/source/CarbonHeaders/CarbonHeaders-9A581/Finder.h">CarbonHeaders
    source</a></li>
<li><a href="http://www.opensource.apple.com/source/xnu/xnu-1486.2.11/bsd/vfs/vfs_xattr.c">Mac OS X 10.6.2
    source</a></li>
<li><a href="https://web.archive.org/web/20120721220757/http://users.phg-online.de/tk/netatalk/doc/Apple/v1/">AppleSingle and AppleDouble v1 format
    internals</a></li>
<li><a href="https://archive.org/details/AppleSingle_AppleDouble">AppleSingle/AppleDouble Formats for Foreign Files Developer&rsquo;s Note
    (version2)</a></li>
<li><a href="https://web.archive.org/web/20160327000117/https://support.apple.com/kb/TA21622?locale=en_US">AppleShare: Platforms and Mac OS Releases Supported</a></li>
<li><a href="https://web.archive.org/web/20150402101950/https://support.apple.com/kb/TA21611?locale=en_US">AppleShare and AppleShare IP File Sharing: Chart of All Limitations</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/Networking/Conceptual/AFP/AFPVersionDifferences/AFPVersionDifferences.html#//apple_ref/doc/uid/TP40000854-CH230-SW1">AFP Version Differences</a></li>
</ul><hr />
    <p>
        This is a mirror of the Netatalk GitHub Wiki.
        Please <a href="https://github.com/Netatalk/netatalk/wiki/Developer-Notes">visit the original page</a>
        if you want to correct an error or contribute new contents.
    </p>
    <p>Last updated 2024-09-13</p>
    <hr />
    </div>
<div class="footer">
    <a href="https://validator.w3.org/check?uri=referer">
      <img src="https://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Strict" height="31" width="88" />
    </a>
    <a href="https://jigsaw.w3.org/css-validator/check?uri=referer">
      <img style="border:0;width:88px;height:31px"
      src="https://jigsaw.w3.org/css-validator/images/vcss" alt="Valid CSS!" />
    </a>
</div>
</body>
</html>

