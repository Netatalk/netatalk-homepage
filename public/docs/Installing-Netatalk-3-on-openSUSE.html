<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Netatalk Wiki - Installing Netatalk 3 on openSUSE</title>
    <meta name="description" content="Netatalk Wiki">
    <link rel="canonical" href="https://netatalk.io/docs/Installing-Netatalk-3-on-openSUSE">
    <link rel="stylesheet" type="text/css" href="https://netatalk.io/css/site.css" />
    <link rel="icon" type="image/x-icon" href="https://netatalk.io/gfx/favicon.ico" />
</head>
<body>
<div id="header">
    <div id="logo"></div>
    <div id="menlinks">
        <a href="/" title="Return to Netatalk home">[main]</a>
        <a href="/docs" title="Netatalk Wiki">[wiki]</a>
        <a href="/documentation.html" title="Netatalk Manual">[documentation]</a>
        <a href="/download.html" title="Download Netatalk">[downloads]</a>
        <a href="/support.html" title="Support">[support]</a>
        <a href="/links.html" title="Netatalk related links">[links]</a>
        <img src="/gfx/end.gif" alt="" width="125" height="7" />
    </div>
</div>

<div id="header-print">
    <h1>netatalk.io</h1>
</div>

<div class="search">
    <h2>search netatalk.io</h2>
    <form method="get" action="https://www.google.com/search">
        <p>
            <input type="text" name="q" size="10" maxlength="255" value="" title="enter search text" />
            <input type="hidden" name="sitesearch" value="netatalk.io" />
            <input type="submit" name="btnG" value="Go" title="search netatalk.io" />
        </p>
    </form>
    <span class="italic">powered by Google</span>
</div>

<div id="navbars">
<div class="navbar">
<h2>Table of contents</h2>
<p>Resources</p>
<ul>
<li><a class="wikilink" href="/docs/FAQ.html">FAQ</a></li>
<li><a class="wikilink" href="/docs/Troubleshooting.html">Troubleshooting</a></li>
<li><a class="wikilink" href="/docs/Connect-to-AFP-Server.html">Connect to AFP Server</a></li>
<li><a class="wikilink" href="/docs/Webmin-Module.html">Webmin Module</a></li>
<li><a class="wikilink" href="/docs/Benchmarks.html">Benchmarks</a></li>
</ul>
<p>Netatalk v3 Installation</p>
<ul>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-Fedora-Linux.html">Installing Netatalk 3 on Fedora Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-FreeBSD.html">Installing Netatalk 3 on FreeBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-macOS.html">Installing Netatalk 3 on macOS</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-OpenBSD.html">Installing Netatalk 3 on OpenBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-OpenIndiana.html">Installing Netatalk 3 on OpenIndiana</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-openSUSE.html">Installing Netatalk 3 on openSUSE</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-Solaris.html">Installing Netatalk 3 on Solaris</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-3-on-Ubuntu.html">Installing Netatalk 3 on Ubuntu</a></li>
</ul>
<p>Netatalk v2 Installation</p>
<ul>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-Alpine-Linux.html">Installing Netatalk 2 on Alpine Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-Debian-Linux.html">Installing Netatalk 2 on Debian Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-Fedora-Linux.html">Installing Netatalk 2 on Fedora Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-macOS.html">Installing Netatalk 2 on macOS</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-NetBSD.html">Installing Netatalk 2 on NetBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-2-on-OmniOS.html">Installing Netatalk 2 on OmniOS</a></li>
</ul>
<p>Technical Docs</p>
<ul>
<li><a class="wikilink" href="/docs/CatalogSearch.html">CatalogSearch</a></li>
<li><a class="wikilink" href="/docs/Kerberos.html">Kerberos</a></li>
<li><a class="wikilink" href="/docs/Special-Files-and-Folders.html">Special Files and Folders</a></li>
<li><a class="wikilink" href="/docs/Spotlight.html">Spotlight</a></li>
<li><a class="wikilink" href="/docs/AppleTalk-Kernel-Module.html">AppleTalk Kernel Module</a></li>
<li><a class="wikilink" href="/docs/Print-Server.html">Print Server</a></li>
</ul>
<p>Development</p>
<ul>
<li><a class="wikilink" href="/docs/Developer-Notes.html">Developer Notes</a></li>
<li><a class="wikilink" href="/docs/Developer-FAQ.html">Developer FAQ</a></li>
<li><a class="wikilink" href="/docs/Work-with-Documentation.html">Work with Documentation</a></li>
<li><a class="wikilink" href="/docs/Release-Process.html">Release Process</a></li>
<li><a class="wikilink" href="/docs/Using-GDB-to-Analyze-a-Crash.html">Using GDB to Analyze a Crash</a></li>
</ul>
</div></div>
<div id="content">
<h1 id="Installing-Netatalk-3-on-openSUSE">Installing Netatalk 3 on openSUSE</h1><hr/>
<h1>Overview</h1>
<p>This installation guide was originally written for Netatalk 3.1.11 on
openSUSE Leap 42.2</p>
<h2>Required Packages</h2>
<p>Install the following packages by <code>zypper in</code>.</p>
<ul>
<li><code>gcc</code></li>
<li><code>libtool</code></li>
<li><code>make</code></li>
<li><code>libevent-devel</code> (used by netatalk(8))</li>
<li><code>db-devel</code> (dbd CNID backend)</li>
<li><code>libtdb-devel</code> (tdb CNID backend)</li>
<li><code>libmysqlclient-devel</code> (mysql CNID backend)</li>
<li><code>libgcrypt-devel</code> (DHX2 auth)</li>
<li><code>libopenssl-devel</code> or <code>libressl-devel</code> (DHX auth aka DHCAST128)</li>
<li><code>krb5-devel</code> (Kerberos V auth)</li>
<li><code>pam-devel</code> (PAM)</li>
<li><code>libavahi-devel</code> (Bonjour support)</li>
<li><code>cracklib-devel</code> (password ckeck)</li>
<li><code>tcpd-devel</code> (TCP Wrapper)</li>
<li><code>libacl-devel</code> (ACL support)</li>
<li><code>openldap2-devel</code> (enhanced ACL support)</li>
<li><code>dbus-1-devel</code> (used by afpstats command)</li>
<li><code>dbus-1-glib-devel</code> (used by afpstats command)</li>
<li><code>glib2-devel</code> (used by afpstats command)</li>
<li><code>perl-IO-Socket-INET6</code> (used by asip-status.pl command)</li>
<li><code>systemtap-sdt-devel</code> (DTrace-compatible)</li>
<li><code>tracker</code> (used for spotlight indexing)</li>
<li><code>tracker-devel</code> (used for spotlight indexing)</li>
</ul>
<h2>Build</h2>
<p>Get the tarball from <a href="http://netatalk.sourceforge.net/">Netatalk Web
Site</a>.</p>
<p>Extract the tarball.</p>
<pre><code>$ tar xvf netatalk-3.1.11.tar.bz2
$ cd netatalk-3.1.11
</code></pre>
<p>You should read the help message, in order to know configure options.</p>
<p>If the applicable libraries are installed, many options will be detected
automatically.</p>
<pre><code>$ ./configure --help
</code></pre>
<p>Do configure! The following options are not auto-detected.</p>
<pre><code>$ ./configure \
   --with-init-style=suse-systemd \
   --without-libevent \
   --without-tdb \
   --with-cracklib \
   --enable-krbV-uam \
   --with-pam-confdir=/etc/pam.d \
   --with-dbus-sysconf-dir=/etc/dbus-1/system.d \
   --with-tracker-pkgconfig-version=1.0
</code></pre>
<p>The version 1.0 <code>--with-tracker-pkgconfig-version=1.0</code> must match the
pkg-config version of the installed Tracker libraries. Use the following
commands for finding the version info:</p>
<pre><code>$ pkg-config --list-all | grep tracker
...
</code></pre>
<p>On successful completion, you will see a report similar to the
following:</p>
<pre><code>Compilation summary:

   CPPFLAGS       = -I$(top_srcdir)/include -I$(top_builddir)/include -I$(top_srcdir)
   CFLAGS         = -D_U_=&quot;__attribute__((unused))&quot; -g -O2
   LIBS           =  -lcrack
   PTHREADS:
       LIBS   =
       CFLAGS = -pthread
   TRACKER:
       LIBS   = -ltracker-sparql-1.0 -lgio-2.0 -lgobject-2.0 -Wl,--export-dynamic -lgmodule-2.0 -pthread -lglib-2.0
       CFLAGS = -pthread -I/usr/include/tracker-1.0 -I/usr/include/tracker-1.0/libtracker-sparql -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include
   SSL:
       LIBS   =  -L/usr/lib64 -lcrypto
       CFLAGS =  -I/usr/include/openssl
   LIBGCRYPT:
       LIBS   = -L/usr/lib64 -lgcrypt -ldl -lgpg-error
       CFLAGS =
   PAM:
       LIBS   =  -lpam
       CFLAGS =
   WRAP:
       LIBS   = -lwrap
       CFLAGS =
   BDB:
       LIBS   =  -L/usr/lib64 -ldb
       CFLAGS =
   GSSAPI:
       LIBS   = -lgssapi_krb5  -lcrack
       CFLAGS = -D_U_=&quot;__attribute__((unused))&quot; -g -O2
   ZEROCONF:
       LIBS   =  -lavahi-common -lavahi-client
       CFLAGS =  -D_REENTRANT
   LDAP:
       LIBS   =  -lldap
       CFLAGS =
   LIBEVENT:
       LIBS   =
       CFLAGS =
   TDB:
       LIBS   = -ltdb
       CFLAGS =
   MySQL:
       LIBS   = -L/usr/lib64 -lmysqlclient -lpthread -lz -lm -lssl -lcrypto -ldl
       CFLAGS = -I/usr/include/mysql

Configure summary:

   INIT STYLE:
        suse-systemd
   AFP:
        Extended Attributes: ad | sys
        ACL support: yes
        Spotlight: yes
   CNID:
        backends:  dbd last tdb mysql
   UAMS:
        DHX     (PAM SHADOW)
        DHX2    (PAM SHADOW)
        RANDNUM (afppasswd)
        Kerberos V
        clrtxt  (PAM SHADOW)
        guest
   Options:
        Zeroconf support:        yes
        tcp wrapper support:     yes
        quota support:           yes
        valid shell check:       yes
        cracklib support:        yes
        ACL support:             auto
        Kerberos support:        auto
        LDAP support:            yes
        AFP stats via dbus:      yes
        dtrace probes:           yes
   Paths:
        Netatalk lockfile:       /var/lock/netatalk
        init directory:          /usr/lib/systemd/system
        dbus system directory:   /etc/dbus-1/system.d
        dbus daemon path:        /bin/dbus-daemon
        tracker prefix:          /usr
        tracker install prefix:  /usr
        tracker manager:         /usr/bin/tracker daemon
        pam config directory:    /etc/pam.d
   Documentation:
        Docbook:                 no
</code></pre>
<p>Docbook is not needed because it is for developers only.</p>
<p>Make and install.</p>
<pre><code>$ make
# make install
</code></pre>
<h2>Check</h2>
<p>Check features and paths, using <code>netatalk -V</code> and <code>afpd -V</code>.</p>
<pre><code>$ /usr/local/sbin/netatalk -V netatalk 3.1.11 - Netatalk AFP server
service controller daemon

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or (at
your option) any later version. Please see the file COPYING for
further information and details.

netatalk has been compiled with support for these features:

     Zeroconf support: Avahi
    Spotlight support: Yes

                 afpd: /usr/local/sbin/afpd
           cnid_metad: /usr/local/sbin/cnid_metad
      tracker manager: /usr/bin/tracker daemon
          dbus-daemon: /bin/dbus-daemon
             afp.conf: /usr/local/etc/afp.conf
    dbus-session.conf: /usr/local/etc/dbus-session.conf
   netatalk lock file: /var/lock/netatalk
</code></pre>
<pre><code>$ /usr/local/sbin/afpd -V
afpd 3.1.11 - Apple Filing Protocol
(AFP) daemon of Netatalk

This program is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2 of the License, or (at
your option) any later version. Please see the file COPYING for
further information and details.

afpd has been compiled with support for these features:

         AFP versions: 2.2 3.0 3.1 3.2 3.3 3.4
        CNID backends: dbd last tdb mysql
     Zeroconf support: Avahi
 TCP wrappers support: Yes
        Quota support: Yes
  Admin group support: Yes
   Valid shell checks: Yes
     cracklib support: Yes
           EA support: ad | sys
          ACL support: Yes
         LDAP support: Yes
        D-Bus support: Yes
    Spotlight support: Yes
        DTrace probes: Yes`

             afp.conf: /usr/local/etc/afp.conf
          extmap.conf: /usr/local/etc/extmap.conf
      state directory: /usr/local/var/netatalk/
   afp_signature.conf: /usr/local/var/netatalk/afp_signature.conf
     afp_voluuid.conf: /usr/local/var/netatalk/afp_voluuid.conf
      UAM search path: /usr/local/lib/netatalk//
 Server messages path: /usr/local/var/netatalk/msg/
</code></pre>
<h2>Setting</h2>
<p>Edit <code>/usr/local/etc/afp.conf</code>.</p>
<p>Ex:</p>
<pre><code>[Global]

[Homes]

   basedir regex = /home

[Test Volume]

   path = /export/test1

[My Time Machine Volume]

   path = /export/timemachine
   time machine = yes
</code></pre>
<p>It&rsquo;s recommended to enable extended attributes of filesystem. It&rsquo;s no
problem in case of btrfs.</p>
<p>If you use ext2,3 or 4, you should check it by <code>getfattr</code> and
<code>setfattr</code> commands. If you use ACL, you shoud check it by <code>getfacl</code>
and <code>setfacl</code> commands. If these are disabled, use <code>tune2fs</code> command
or edit <code>/etc/fstab</code> file.</p>
<p>Ex:</p>
<pre><code> /dev/sdc2    /mountpoint    ext4    defaults,user_xattr,acl    0 2
</code></pre>
<p>You should check firewall. AFP&rsquo;s port number is <code>548</code>. Zeroconf&rsquo;s port
number is <code>5353</code>.</p>
<h2>Enabling and Starting</h2>
<p>You must run Avahi ahead of Netatalk.</p>
<pre><code># systemctl enable avahi-daemon
# systemctl enable netatalk
# systemctl start avahi-daemon
# systemctl start netatalk
</code></pre>
<h2>Spotlight Feature</h2>
<p>If you use Spotlight feature, read
<a href="http://netatalk.sourceforge.net/3.1/htmldocs/configuration.html">Spotlight</a>
section in Netatalk Manual.</p>
<p>Set <code>spotlight = yes</code>.</p>
<p>Set <code>spotlight = no</code> for Time Machine&rsquo;s volume. The mining for
sparsebundle is wasteful.</p>
<p>Ex:</p>
<pre><code>[Global]

   spotlight = yes

[Homes]

   basedir regex = /home

[Test Volume]

   path = /export/test1

[My Time Machine Volume]

   path = /export/timemachine
   time machine = yes
   spotlight = no
</code></pre>
<h2>Interoperation with Samba</h2>
<p>Recent Netatalk and Samba can store metadata in the compatible format.</p>
<p>Using this way, the following access becomes possible.</p>
<ul>
<li>from Mac to Netatalk</li>
<li>from Mac to Samba</li>
<li>from Windows to Samba</li>
</ul>
<h3>Netatalk</h3>
<p>Using <code>vol preset</code> option, the same configuration is set for all
volumes.</p>
<p>Using <code>ea = samba</code>, Extended Attributes become compatible with Samba.</p>
<p>Edit <code>/usr/local/etc/afp.conf</code>.</p>
<p>Ex:</p>
<pre><code>[Global]

   vol preset = my default values

[my default values]

   ea = samba

[Homes]

   basedir regex = /home

[Test Volume]

   path = /export/test1

[My Time Machine Volume]

   path = /export/timemachine
   time machine = yes
</code></pre>
<h3>Samba</h3>
<p>Setting various options in <code>[global]</code>, the same configuration is set for
all shares.</p>
<p>Three vfs objects (catia, fruit and streams_xattr) provide enhanced
compatibility with Apple SMB clients and interoperability with a
Netatalk.</p>
<p>Using <code>hide files</code>, the invisible files created via Netatalk are
hidden from Windows. Use <code>hide files</code>, not <code>veto files</code>.</p>
<p>Don&rsquo;t use <code>fruit:locking = netatalk</code> because it has <a href="https://lists.samba.org/archive/samba/2015-December/196828.html">a
bug</a>.</p>
<p><code>[My Time Machine Volume]</code> is commented out because Time Machine feature
can not be used via SMB.</p>
<p>Edit <code>/etc/samba/smb.conf</code>.</p>
<p>Ex:</p>
<pre><code>[global]

   foo = bar
   baz = qux`

   ea support = Yes
   vfs objects = catia fruit streams_xattr`

fruit:locking = netatalk  

   fruit:encoding = native
   streams_xattr:prefix = user.
   streams_xattr:store_stream_type = no`

   hide files = /.DS_Store/Network Trash Folder/TheFindByContentFolder/TheVolumeSettingsFolder/Temporary Items/.TemporaryItems/.VolumeIcon.icns/Icon?/.FBCIndex/.FBCLockFolder/`

   read only = No`

[homes]

[Test Volume]

   path = /export/test1`

[My Time Machine Volume]  
path = /export/timemachine  
</code></pre><hr />
    <p>
        This is a mirror of the Netatalk GitHub Wiki.
        Please <a href="https://github.com/Netatalk/netatalk/wiki/Installing-Netatalk-3-on-openSUSE">visit the original page</a>
        if you want to correct an error or contribute new contents.
    </p>
    <p>Last updated 2024-06-01</p>
    <hr />
    </div>
<div class="footer">
    <a href="https://validator.w3.org/check?uri=referer">
      <img src="https://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Strict" height="31" width="88" />
    </a>
    <a href="https://jigsaw.w3.org/css-validator/check?uri=referer">
      <img style="border:0;width:88px;height:31px"
      src="https://jigsaw.w3.org/css-validator/images/vcss" alt="Valid CSS!" />
    </a>
</div>
</body>
</html>

