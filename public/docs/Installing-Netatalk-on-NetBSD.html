<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Netatalk Wiki - Installing Netatalk on NetBSD</title>
    <meta name="description" content="Netatalk Wiki">
    <link rel="canonical" href="https://netatalk.io/docs/Installing-Netatalk-on-NetBSD">
    <link rel="stylesheet" type="text/css" href="https://netatalk.io/css/site.css" />
    <link rel="icon" type="image/x-icon" href="https://netatalk.io/gfx/favicon.ico" />
</head>
<body>
<div id="header">
    <div id="logo"></div>
    <div id="menlinks">
        <a href="/" title="Return to Netatalk home">[main]</a>
        <a href="/docs" title="Netatalk Wiki">[wiki]</a>
        <a href="/documentation.html" title="Netatalk Manual">[documentation]</a>
        <a href="/download.html" title="Download Netatalk">[downloads]</a>
        <a href="/support.html" title="Support">[support]</a>
        <a href="/links.html" title="Netatalk related links">[links]</a>
        <img src="/gfx/end.gif" alt="" width="125" height="7" />
    </div>
</div>

<div id="header-print">
    <h1>netatalk.io</h1>
</div>

<div class="search">
    <h2>search netatalk.io</h2>
    <form method="get" action="https://www.google.com/search">
        <p>
            <input type="text" name="q" size="10" maxlength="255" value="" title="enter search text" />
            <input type="hidden" name="sitesearch" value="netatalk.io" />
            <input type="submit" name="btnG" value="Go" title="search netatalk.io" />
        </p>
    </form>
    <span class="italic">powered by Google</span>
</div>

<div id="navbars">
<div class="navbar">
<h2>Table of contents</h2>
<p>Resources</p>
<ul>
<li><a class="wikilink" href="/docs/FAQ.html">FAQ</a></li>
<li><a class="wikilink" href="/docs/Troubleshooting.html">Troubleshooting</a></li>
<li><a class="wikilink" href="/docs/Connect-to-AFP-Server.html">Connect to AFP Server</a></li>
<li><a class="wikilink" href="/docs/Webmin-Module.html">Webmin Module</a></li>
<li><a class="wikilink" href="/docs/Benchmarks.html">Benchmarks</a></li>
</ul>
<p>OS Specific Guides</p>
<ul>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-Alpine-Linux.html">Installing Netatalk on Alpine Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-Debian-Linux.html">Installing Netatalk on Debian Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-Fedora-Linux.html">Installing Netatalk on Fedora Linux</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-FreeBSD.html">Installing Netatalk on FreeBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-macOS.html">Installing Netatalk on macOS</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-NetBSD.html">Installing Netatalk on NetBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-OmniOS.html">Installing Netatalk on OmniOS</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-OpenBSD.html">Installing Netatalk on OpenBSD</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-OpenIndiana.html">Installing Netatalk on OpenIndiana</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-openSUSE.html">Installing Netatalk on openSUSE</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-Solaris.html">Installing Netatalk on Solaris</a></li>
<li><a class="wikilink" href="/docs/Installing-Netatalk-on-Ubuntu.html">Installing Netatalk on Ubuntu</a></li>
</ul>
<p>Technical Docs</p>
<ul>
<li><a class="wikilink" href="/docs/CatalogSearch.html">CatalogSearch</a></li>
<li><a class="wikilink" href="/docs/Kerberos.html">Kerberos</a></li>
<li><a class="wikilink" href="/docs/Special-Files-and-Folders.html">Special Files and Folders</a></li>
<li><a class="wikilink" href="/docs/Spotlight.html">Spotlight</a></li>
<li><a class="wikilink" href="/docs/AppleTalk-Kernel-Module.html">AppleTalk Kernel Module</a></li>
<li><a class="wikilink" href="/docs/Print-Server.html">Print Server</a></li>
<li><a class="wikilink" href="/docs/MacIP-Gateway.html">MacIP Gateway</a></li>
</ul>
<p>Development</p>
<ul>
<li><a class="wikilink" href="/docs/Roadmap.html">Roadmap</a></li>
<li><a class="wikilink" href="/docs/Developer-Notes.html">Developer Notes</a></li>
<li><a class="wikilink" href="/docs/Developer-FAQ.html">Developer FAQ</a></li>
<li><a class="wikilink" href="/docs/Work-with-Documentation.html">Work with Documentation</a></li>
<li><a class="wikilink" href="/docs/Release-Process.html">Release Process</a></li>
<li><a class="wikilink" href="/docs/Testing.html">Testing</a></li>
<li><a class="wikilink" href="/docs/Using-GDB-to-Analyze-a-Crash.html">Using GDB to Analyze a Crash</a></li>
</ul>
</div></div>
<div id="content">
<h1 id="Installing-Netatalk-on-NetBSD">Installing Netatalk on NetBSD</h1>
<h1>Install the latest Netatalk</h1>
<p>NetBSD is one out of a handful of distributions that still actively maintain an AppleTalk kernel module.</p>
<p>The pkgsrc package repository distributes a <a href="https://pkgsrc.se/net/netatalk4">netatalk4</a>, a <a href="https://pkgsrc.se/net/netatalk3">netatalk3</a> as well as a <a href="https://pkgsrc.se/net/netatalk22">netatalk22</a> package, which can be installed with <code>pkg_add</code>.</p>
<p>For building and installing from source yourself, find links to the official documentation below.</p>
<ul>
<li><strong><a href="https://netatalk.io/oldstable/htmldocs/compile#build-netbsd">Compile Netatalk from Source: NetBSD</a></strong> in the Manual</li>
<li><strong><a href="https://github.com/Netatalk/netatalk/blob/branch-netatalk-2-4/INSTALL.md">INSTALL.md</a></strong> in the source tree</li>
</ul>
<h1>Required packages</h1>
<p>Before starting, make sure you have a <a href="http://www.netbsd.org/docs/misc/index.html#package-management">working pkgsrc environment</a>.</p>
<p>At this point, you should be able to install the latest netatalk package with <code>pkg_add</code> (root privileges required.)</p>
<pre><code>pkg_add netatalk
</code></pre>
<h1>Configuration</h1>
<p>In older versions of Netatalk, you had to enable the NetBSD init script with the <code>--enable-netbsd</code> or equivalent compile time flag.</p>
<p>Once installed, you can control the netatalk service as <a href="https://www.netbsd.org/docs/guide/en/chap-rc.html">any other NetBSD service</a>.</p>
<p>If needed, manually copy the installed netatalk initscripts to the <code>/etc/rc.d</code> directory.</p>
<h1>AppleTalk</h1>
<p>NetBSD comes with an AppleTalk kernel module which Netatalk can use for DDP transport protocol out of the box on most configurations. Source for this module is available under <code>/usr/src/sys/netatalk</code> in the source tree.</p>
<p>Some NetBSD ports, notably evbarm (arm64), are built with the NETATALK kernel module disabled by default. To test this, try running the atalkd service. If you get the following error messages, it means that your kernel was not built with netatalk support:</p>
<pre><code># service atalkd onestart
Starting atalkd.
socket: Address family not supported by protocol family
socket: Address family not supported by protocol family
atalkd: can't get interfaces, exiting.
</code></pre>
<h2>Rebuilding the kernel to enable netatalk (if necessary)</h2>
<p>If you see these &ldquo;Address family not supported by protocol family&rdquo; errors, you can try building your own kernel with NETATALK enabled. First, you&rsquo;ll need to download the kernel source. This is the <code>syssrc.tgz</code> file that can be found online in the <code>/source/sets</code> directory for your build version (e.g. <code>https://cdn.netbsd.org/pub/NetBSD/NetBSD-10.0/source/sets/syssrc.tgz</code>). Extract the source tarball as root:</p>
<pre><code># cd /
# tar xzf /path/to/syssrc.tgz
</code></pre>
<p>This puts the source code under /usr/src. Look for your architecture under <code>/usr/src/sys/arch/</code>, then find the configuration file in the <code>conf</code> directory that was used to build your kernel. You can find which configuration was used by running <code>uname -a</code>:</p>
<pre><code># uname -a
NetBSD arm64 10.0 NetBSD 10.0 (GENERIC64) #0: Thu Dec 12 16:59:45 PST 2024  root@arm64:/usr/src/sys/arch/evbarm/compile/GENERIC64 evbarm
</code></pre>
<p>In this example, our kernel was built for the <code>evbarm</code> architecture using the <code>GENERIC64</code> configuration. Inspecting the file <code>/usr/src/sys/arch/evbarm/conf/GENERIC64</code> does not show any instances of the string <code>NETATALK</code>, but we see it includes three other files:</p>
<pre><code>include &quot;arch/evbarm/conf/std.generic64&quot;
include &quot;arch/evbarm/conf/files.generic64&quot;
include &quot;arch/evbarm/conf/GENERIC.common&quot;
</code></pre>
<p>and in <code>GENERIC.common</code>, the following line is commented out:</p>
<pre><code>#options         NETATALK        # AppleTalk networking
</code></pre>
<p>Uncomment the line by removing the leading <code>#</code>, save the file, and you are ready to follow the <a href="https://netbsd.org/docs/guide/en/chap-kernel.html">instructions for rebuilding and installing the new kernel.</a>.</p>
<h2>Configure DDP-based services</h2>
<p>In order to register with the AppleTalk protocols, the <code>/etc/services</code> file must contain proper protocol definitions. Make sure the following entries are present on your installation:</p>
<pre><code>rtmp        1/ddp       # Routing Table Maintenance Protocol
nbp     2/ddp       # Name Binding Protocol
echo        4/ddp       # AppleTalk Echo Protocol
zip     6/ddp       # Zone Information Protocol

afpovertcp  548/tcp     # AFP over TCP
afpovertcp  548/udp
</code></pre>
<p>From: <a href="https://github.com/Netatalk/netatalk/blob/main/config/services.atalk">services.atalk</a> in the Netatalk code tree</p><hr />
    <p>
        This is a mirror of the Netatalk GitHub Wiki.
        Please <a href="https://github.com/Netatalk/netatalk/wiki/Installing-Netatalk-on-NetBSD">visit the original page</a>
        if you want to correct an error or contribute new contents.
    </p>
    <p>Last updated 2025-01-25</p>
    <hr />
    </div>
<div class="footer">
    <a href="https://validator.w3.org/check?uri=referer">
      <img src="https://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0 Strict" height="31" width="88" />
    </a>
    <a href="https://jigsaw.w3.org/css-validator/check?uri=referer">
      <img style="border:0;width:88px;height:31px"
      src="https://jigsaw.w3.org/css-validator/images/vcss" alt="Valid CSS!" />
    </a>
    <p>Netatalk and the Netatalk website are licensed under the <a href="/stable/htmldocs/gpl">GNU
    General Public License 2.0</a>.</p>
</div>
</body>
</html>
