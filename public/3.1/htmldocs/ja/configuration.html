<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第3章 Netatalk のセットアップ</title><link rel="stylesheet" type="text/css" href="/css/netatalk.css" /><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" /><link rel="home" href="index.html" title="Netatalk 3.1 マニュアル" /><link rel="up" href="index.html" title="Netatalk 3.1 マニュアル" /><link rel="prev" href="installation.html" title="第2章 インストール" /><link rel="next" href="upgrade.html" title="第4章 Netatalk 2 からのアップグレード" /></head><body>
    <div xmlns="" id="header">
        <div id="logo"></div>
        <div id="menlinks">
          <a href="/" title="Return to Netatalk home">[main]</a>
          <a href="http://netatalk.sourceforge.net/wiki/" title="Netatalk Wiki">[wiki]</a>
          <a href="/3.1/htmldocs" title="Netatalk Manual">[documentation]</a>
          <a href="http://sourceforge.net/project/showfiles.php?group_id=8642" title="Download Netatalk from sourceforge">[downloads]</a>
          <a href="/support.php" title="Support">[support]</a>
          <a href="/links.php" title="Netatalk related links">[links]</a>
          <img src="/gfx/end.gif" alt="" width="125" height="7" />
        </div>
    </div>
<div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第3章 Netatalk のセットアップ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="installation.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="upgrade.html">次へ</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a id="configuration"></a>第3章 Netatalk のセットアップ</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Eiichirou</span> <span class="surname">UDA（日本語訳）</span></h3></div></div><div><p class="pubdate">2016 年 7 月 26 日（訳）</p></div></div></div><div class="toc"><p><strong>目次</strong></p><dl class="toc"><dt><span class="sect1"><a href="configuration.html#idm230">ファイルサービス</a></span></dt><dd><dl><dt><span class="sect2"><a href="configuration.html#idm239">AFP ファイルサーバーのセットアップ</a></span></dt><dt><span class="sect2"><a href="configuration.html#CNID-backends">CNID バックエンド</a></span></dt><dt><span class="sect2"><a href="configuration.html#charsets">Charsets/Unicode</a></span></dt><dt><span class="sect2"><a href="configuration.html#authentication">認証</a></span></dt><dt><span class="sect2"><a href="configuration.html#acls">ACL のサーポート</a></span></dt><dt><span class="sect2"><a href="configuration.html#fce">ファイルシステム変更イベント</a></span></dt></dl></dd><dt><span class="sect1"><a href="configuration.html#idm945">Spotlight</a></span></dt><dd><dl><dt><span class="sect2"><a href="configuration.html#idm951">設定</a></span></dt><dt><span class="sect2"><a href="configuration.html#idm963">制限と注意</a></span></dt><dt><span class="sect2"><a href="configuration.html#idm973">サーバー上での Tracker コマンドラインツールの使用</a></span></dt><dt><span class="sect2"><a href="configuration.html#idm1045">Tracker コマンドラインのより進んだ設定</a></span></dt><dt><span class="sect2"><a href="configuration.html#idm1070">サポートされているメタデータ属性</a></span></dt><dt><span class="sect2"><a href="configuration.html#idm1147">参考</a></span></dt></dl></dd><dt><span class="sect1"><a href="configuration.html#idm1156">Netatalk の起動と停止</a></span></dt></dl></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm230"></a>ファイルサービス<a id="idm232" class="indexterm"></a></h2></div></div></div><p>Netatalk は AFP<a id="idm236" class="indexterm"></a> サービスを提供するものである．</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm239"></a>AFP ファイルサーバーのセットアップ</h3></div></div></div><p>AFP (Apple Filing Protocol) はアップル・マッキントッシュのファイルサービスに用いるプロトコルである．
      AFP プロトコルは年を追うごとに進展を見せ，最新の変更は OS X Lion<a id="idm242" class="indexterm"></a> (10.7) のマイナーリリースにあわせて加えられた "AFP 3.4" である．</p><p>afpd デーモンはアップルのクライアントに対してファイルサービスを提供する．唯一必要な設定ファイルは  
      <code class="filename">afp.conf</code> のみで，"ini" スタイルの構文で記述する．</p><p><a class="link" href="configuration.html#spotlight">Spotlight</a><a id="idm249" class="indexterm"></a> サポートは Netatalk 3.1 より加えられた．Spotlight をサポートした Netatalk を
      コンパイルするための情報はこの<a class="link" href="installation.html#spotlight-compile" title="Spotlight">節</a>を参照のこと．</p><p>Mac OS X 10.5 (Leopard) で，AFP 経由での Time Machine バックアップがサポートされるようになった．
      二つの新機能で，バックアップをただサーバーのキャッシュにではなく，
      動作中のディスクに書き込むことを確実にしている．ホストのオペレーティングシステムが異なると，
      このキャッシュをフラッシュする払い出し方も異なる．ヴォリュームを作成するために，
      Time Machine ターゲットのボリューム作成にはボリュームオプション "<code class="option">time machine = yes</code>" を使用する．</p><p>Netatalk 2.1 以降では UNIX シンボリックリンク<a id="idm255" class="indexterm"></a>をサーバー上で使うことができる．セマンティクスは例えば NFS と同じである，
      すなわち，Netatalk はサーバー側でシンボリックリンクを追わないが，
      代わりにクライアント側でシンボリックリンクを解決できるよう完全に転送して，
      結果としてクライアントのファイルシステムのビュー内でしかるべき場所を示すリンクとなる．</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm258"></a>afp.conf</h4></div></div></div><p><code class="filename">afp.conf</code> は，AFP ファイルサーバー及び提供する AFP 
        ボリュームの挙動と設定を決定するために afpd が使用する設定ファイルである．</p><p><code class="filename">afp.conf</code> は複数のサーバーセクションに分割できる．すなわち：
          </p><div class="variablelist"><dl class="variablelist"><dt><span class="term">[Global]</span></dt><dd><p>グローバルセクションで基本的なサーバーオプションを定義する</p></dd><dt><span class="term">[Homes]</span></dt><dd><p>ホームセクションでユーザーのホームボリュームを定義する</p></dd></dl></div><p><code class="option">Global</code> とも 
          <code class="option">Homes</code>，とも呼ばれないセクションは単なる一つの AFP 
          ボリュームであると解釈される</p><p><code class="option">Homes</code> を定義してユーザーのホームディレクトリを共有するために，
        <code class="option">basedir regex</code> オプションを明記しなければならない．
        これは全てのユーザーのホームの親ディレクトリのパスあるいは正規表現からなる単純な文字列でよい．</p><p>例：</p><pre class="programlisting">[Homes]
basedir regex = /home
</pre><p>この場合，AFP サーバーにログインできるユーザーはそれぞれ <code class="filename">/home/（ユーザー名）</code> 
        というパス名でのユーザーボリュームを使用できる．</p><p>より複雑なセットアップで，例えば二つの異なったファイルシステムにわたって分割された，
        大量のユーザーホームディレクトリーのあるサーバーなら：
          </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>/RAID1/homes</p></li><li class="listitem"><p>/RAID2/morehomes</p></li></ul></div><p>以下の設定が必要である：</p><pre class="programlisting">[Homes]
basedir regex = /RAID./.*homes
</pre><p>もし，<code class="option">basedir regex</code> にシンボリックリンクが含まれる場合，
        正規化された絶対パスを指定すべきである．つまり，パス <code class="filename">/home</code> から 
        <code class="filename">/usr/home</code> にシンボリックリンクがはられていた場合：</p><pre class="programlisting">[Homes]
basedir regex = /usr/home</pre><p>他の使用できるオプションの詳細な解説については <span class="citerefentry"><span class="refentrytitle">afp.conf</span>(5)</span> の man page を参照いただきたい．</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="CNID-backends"></a>CNID<a id="idm301" class="indexterm"></a> バックエンド<a id="idm304" class="indexterm"></a></h3></div></div></div><p>SMB や NFS のようなほかのプロトコルとは異なり，ほとんどの場合，
      AFP プロトコルはファイルやディレクトリをパスではなく ID を通して参照している．
      （その ID は CNID とも言われ，カタログ・ノード ID (Catalog Node ID) の略である）
      典型的には，まず AFP リクエストで，例えば，<span class="phrase">“サーバーさん id 167 のディレクトリにある，
      ファイル名 'Test' というのを開いてください．”</span>といった調子でディレクトリ ID<a id="idm309" class="indexterm"></a>とファイル名を用いる．
      例えば，Mac での "Aliases" は基本的には ID 
      として作用する（より最近の AFP クライアントでは絶対パスにフォールバックするが，
      これは Finder のみで当てはまることであり，アプリケーションでは当てはまらない）．</p><p>AFP ボリュームにある各々のファイルに一意のファイル ID<a id="idm313" class="indexterm"></a> が割り当てられる．仕様により ID は絶対に再利用禁止であり，ID は 32 bit の数字である．
      （ディレクトリ ID も同じ ID プールを使用する）このため，
      ある AFP ボリュームにおよそ 40 億個以上のファイル・フォルダーを書き込むと，
      その時点で ID プールが枯渇され，当該ボリュームへの新ファイルの書き込みができなくなる．
      愚痴はなしということでお願いしたい :-)</p><p>Netatalk はホストのファイルシステム内で 
      ID とファイルあるいはフォルダーのマップ（ID との対応付け）をする必要がある．
      それを実現するためにいくつかの異なる CNID バックエンド<a id="idm317" class="indexterm"></a>が用意されていて，<span class="citerefentry"><span class="refentrytitle">afp.conf</span>(5)</span> 設定ファイル内で <code class="option">cnid
      scheme</code><a id="idm323" class="indexterm"></a> オプションで選択が可能である．CNID バックエンドは基本的には，
        ストアされた ID &lt;-&gt; 名前を一対一対応させるデータベースである．</p><p>The CNID データベースはデフォルトで <code class="filename">/var/netatalk/CNID</code> に置かれる．</p><p>CNID データベースの検証・修復・再構築のために用いることができる <span class="command"><strong>dbd</strong></span> 
      という名のコマンドが用意されていている．</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">注記</h3><p>netatalk で作業する上で，いくつかの CNID に関する点を留意しておかなければならない．
        すなわち：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>"<code class="option">vol dbnest = yes</code>"
            が指定してある時以外はボリュームをネスト（入れ子）にしてはならない．<a id="idm336" class="indexterm"></a></p></li><li class="listitem"><p>CNID バックエンドはデータベースである．
            それ故 afpd はファイルサーバーとデータベースの混成物とならしめている．</p></li><li class="listitem"><p>もしファイルシステムに空き容量がなくなった場合，データベースは破損するかもしれない．
            それを回避するために取る策としては，<code class="option">vol dbpath</code> オプションを使用して，
            データベースファイルをどこか別の場所に置く，か，クオータ<a id="idm343" class="indexterm"></a>を使っているならば CNID 
            データベースフォルダーがクオータなしでユーザー／グループのオーナーとなっているか確認する．
            のいずれかである．</p></li><li class="listitem"><p>NFS 経由でマウントされているボリュームの CNID データベースには注意すべきである．
            いずれにしろそのような構成にすると決める事自体かなり無謀である．
            が，さらにデータベースもその上に置くとなると決定的にトラブルの元となる．要はデータベースの破損である．
            もしどうしても NFS<a id="idm348" class="indexterm"></a> マウントしたボリュームを使わねばならない場合はデータベースをローカルディスクに置くために
            <code class="option">vol dbpath</code> ディレクティブを使用するべきである．</p></li></ul></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm352"></a>cdb<a id="idm354" class="indexterm"></a></h4></div></div></div><p>“コンカレント（concurrent:同時進行）データベース”バックエンドは Berkeley DB を基礎としたものである．
        このバックエンドだと複数の afpd デーモンが CNID データベースに直接アクセスできる．
        たとえ複数の afpd プロセスがある一つのボリュームに対して動作中の場合でも同期アクセスについては 
        Berkeley DB ロック機構が全て負ってくれる．欠点としては，一つの afpd 
        プロセスのクラッシュのみでデータベースの破損するかもしれないという点である．
        cdb は数多くのユーザーのホームディレクトリを共有するときのみ使用すべきで，
        <span class="emphasis"><em>かつ</em></span>，
        多数の <span class="command"><strong>cnid_dbd</strong></span> プロセスという状態は確実に問題を引き起こすということである．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm360"></a>dbd<a id="idm362" class="indexterm"></a></h4></div></div></div><p>CNID データベースへのアクセスは cnid_dbd デーモンプロセスのみに制限されている．
        afpd プロセスはデータベースの読み込みと更新のために cnid_dbd デーモン とやりとりをする．
        データベースが破損する可能性は経験的にはゼロである．</p><p>本バックエンドは Netatalk 2.1 以来，デフォルトのバックエンドとなっている．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm367"></a>tdb<a id="idm369" class="indexterm"></a></h4></div></div></div><p><abbr class="abbrev">tdb</abbr> はまた別の永続性のある CNID データベースの一つであり，
        Samba の <span class="emphasis"><em>Trivial Database（軽量データベース）</em></span>のことでもある．
        ユーザーボリューム用として <abbr class="abbrev">cdb</abbr> の代わりに使用することもできる．
          </p><div class="important" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">重要</h3><p>本バックエンドは，いかなる場合でも，共有されても<span class="emphasis"><em>なく</em></span>，
            複数のクライアントが一度にアクセスすることも<span class="emphasis"><em>ない</em></span>
            ボリュームにのみ使用すること．</p></div><p><abbr class="abbrev">tdb</abbr> はメモリーにデータを保持するデータベースとして動作できるので，
        このバックエンドは内部向けに（メモリーにデータを保持する CNID データベースとして），
        最初のデータベースが開けない時など，予備として用いることもできる．
        これはもちろん再起動にすると CNID は失われるということを意味している．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm381"></a>last<a id="idm383" class="indexterm"></a></h4></div></div></div><p>last バックエンドはメモリーにデータを保持する tdb データベースである．それ故永続性がない．
        netatalk 3.0 からは，それは自動的に<span class="emphasis"><em>読み込み専用モード</em></span>になる．
        このバックエンドは例えば CD-ROM などに有用である．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm388"></a>mysql<a id="idm390" class="indexterm"></a></h4></div></div></div><p>CNID バックエンドは MySQL サーバーを使用する．</p></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="charsets"></a>Charsets<a id="idm396" class="indexterm"></a>/Unicode<a id="idm399" class="indexterm"></a></h3></div></div></div><p></p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm402"></a>なぜ Unicode？</h4></div></div></div><p>内部的には，コンピューターは文字（キャラクター）について，
        テキストについて何も知らない，唯一“数字（数）”ならコンピュータにもわかる．
        それ故各々の“字”には“数”が割り当てられている．キャラクターセット，しばしば
        <span class="emphasis"><em>charset</em></span> あるいは
        <span class="emphasis"><em>codepage</em></span><a id="idm407" class="indexterm"></a> とも呼ばれるが，これは“数”と“字”の一対一対応を規定している．</p><p>二つあるいはそれ以上のコンピューターがお互いに通信する必要がある場合，
        各々は同じキャラクターセットを使う必要がある．1960 年代には ASCII<a id="idm410" class="indexterm"></a> (American Standard Code for Information Interchange) 
        キャラクターセットが 
        ASA（米国標準協会：the American Standards Association）によって標準化された．
        オリジナルの ASCII 形式は，
        英語で用いられるアルファベット及び数字を網羅するのに十分な数より多い 128 
        のキャラクターを表している．今日においても，
        ASCII はコンピューターで使われるキャラクタースキームの標準的なものである．</p><p>国際的にもっと都合よく，そして若干内輪向けの記号文字を含めるために，
        つづくバージョンでは 256 のキャラクターを規定した．
        このエンコードの仕様だと一文字はきっちり 1 バイトに収まるが，
        明らかに，256 キャラクターというのは，
        いろいろな言語で用いる全ての文字を一つのキャラクターに一対一対応させるのに依然十分ではなかった．
        </p><p>結果的には後にローカライズされたキャラクターセットが規定された．
        例えば ISO-8859 キャラクターセットである．
        ほとんどのオペレーティングシステムベンダーは自らの要求を満たすために，
        独自のキャラクターセットを導入した．すなわち IBM であれば 
        <span class="emphasis"><em>コードページ 437 (DOSLatinUS)</em></span>，アップルは 
        <span class="emphasis"><em>MacRoman</em></span><a id="idm417" class="indexterm"></a> コードページ，などである．
        127 以上のキャラクターが定義されているものを<span class="emphasis"><em>拡張</em></span>
        キャラクターと呼ぶ．
        これらのキャラクターセットは異なるキャラクターに同じ番号をふってあるので，
        他のキャラクターセットとまたはキャラクターセット同士で衝突を起こす．</p><p>そういったキャラクターセットのほぼ全てが 256 個のキャラクターを定義していて，
        最初の 128 個（0 から 127 まで）のキャラクターを ASCII と同一対応となるようにしている．        
        結果的に，違ったコードページを使っているシステム同士の通信では，事実上
        ASCII キャラクターセット限定となった．</p><p>この問題を新たに解決するために，より大きいキャラクターセットが規定された．
        より多くのキャラクターマッピングの場所を確保するために，
        これらのキャラクターセットは一つのキャラクターの格納のために最低でも 2 バイトを使用する．
        このためそういったキャラクターセットは<span class="emphasis"><em>マルチバイト</em></span>
        キャラクターセットと呼ばれる．</p><p>標準化されたマルチバイトキャラクターエンコード方式として知られているものの一つとして
        <a class="ulink" href="http://www.unicode.org/" target="_top">ユニコード</a>がある．
        マルチバイトキャラクターセット使用の大きな利点として“それ一つで済む”がある．
        二つのコンピューターが通信しているときに両者が同じキャラクターセットを使用しているか確認する必要がない．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm426"></a>Apple で使われている（使われていた）キャラクターセット</h4></div></div></div><p>過去に Apple クライアントは，
        ネットワーク間の通信のためにシングルバイトのキャラクターセットを使用していた．
        年を経るに従い，Apple はいくつものキャラクターセットを定義したが，
        欧米ユーザーは <span class="emphasis"><em>MacRoman</em></span> コードセットを最もよく使用するであろう．</p><p>Apple の定義したコードページに含まれるもの：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>MacArabic, MacFarsi</p></li><li class="listitem"><p>MacCentralEurope</p></li><li class="listitem"><p>MacChineseSimple</p></li><li class="listitem"><p>MacChineseTraditional</p></li><li class="listitem"><p>MacCroation</p></li><li class="listitem"><p>MacCyrillic</p></li><li class="listitem"><p>MacDevanagari</p></li><li class="listitem"><p>MacGreek</p></li><li class="listitem"><p>MacHebrew</p></li><li class="listitem"><p>MacIcelandic</p></li><li class="listitem"><p>MacJapanese</p></li><li class="listitem"><p>MacKorean</p></li><li class="listitem"><p>MacRoman</p></li><li class="listitem"><p>MacRomanian</p></li><li class="listitem"><p>MacThai</p></li><li class="listitem"><p>MacTurkish</p></li></ul></div><p>Mac OS X 以降そして AFP3 以降では <a class="ulink" href="http://www.utf-8.com/" target="_top">UTF-8</a> 
        が用いられる．UTF-8 は Unicode キャラクターを ASCII 互換のやり方でエンコードする．
        各々の Unicode キャラクターは一個から六個の ASCII キャラクターにエンコードされる．
        故に， UTF-8 自体が本当のキャラクターセットなのではなく，ユニコードキャラクターセットのエンコーディングなのである．</p><p>厄介なことにも Unicode はいくつかの <span class="emphasis"><em> <a class="ulink" href="http://www.unicode.org/reports/tr15/index.html" target="_top">normalization（正規化）</a>
        </em></span>方式を規定している．<a class="ulink" href="http://www.samba.org" target="_top">Samba</a><a id="idm470" class="indexterm"></a> はほとんどの Unix ツールも好んで用いる 
        <span class="emphasis"><em>precomposed</em></span><a id="idm473" class="indexterm"></a> Unicode を使用する．一方 Apple は 
        <span class="emphasis"><em>decomposed</em></span><a id="idm477" class="indexterm"></a> normalization を使うことに決めた．</p><p>例として、ドイツ語の文字 '<span class="keycode">ä</span>' についてみてみる．
        Precomposed normalization を使えば Unicode はこの文字に 0xE4 を対応付ける．
        Decomposed normalization では 'ä' を正確には 0x61 と 0x308 の二つの文字に対応付ける．
        0x61 は 'a' に，0x308 は <span class="emphasis"><em>COMBINING
        DIAERESIS</em></span>（訳注：いわゆるウムラウト）に対応付けられている．</p><p>Netatalk では precomposed UTF-8 を
        <span class="emphasis"><em>UTF8</em></span><a id="idm485" class="indexterm"></a> と，decomposed UTF-8 を
        <span class="emphasis"><em>UTF8-MAC</em></span><a id="idm489" class="indexterm"></a> と呼ぶ．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm492"></a>afpd とキャラクターセット</h4></div></div></div><p>新しい AFP 3.x クライアントも古い AFP 2.x クライアントも同時にサポートするために，
        afpd は使われている様々なキャラクターセット間の変換が可能であることを必要とした．
        AFP 3.x クライアントは常に UTF8-MAC を，
        AFP 2.x クライアントは Apple コードページのうちの一つを使う．</p><p>本稿執筆時点（訳注：原文の）で，
        netatalk は以下の Apple コードページをサポートしている：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>MAC_CENTRALEUROPE</p></li><li class="listitem"><p>MAC_CHINESE_SIMP</p></li><li class="listitem"><p>MAC_CHINESE_TRAD</p></li><li class="listitem"><p>MAC_CYRILLIC</p></li><li class="listitem"><p>MAC_GREEK</p></li><li class="listitem"><p>MAC_HEBREW</p></li><li class="listitem"><p>MAC_JAPANESE</p></li><li class="listitem"><p>MAC_KOREAN</p></li><li class="listitem"><p>MAC_ROMAN</p></li><li class="listitem"><p>MAC_TURKISH</p></li></ul></div><p>afpd は三つの異なるキャラクターセットオプションを扱う：</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">unix charset<a id="idm521" class="indexterm"></a></span></dt><dd><p>これはオペレーティングシステムの内側で使われているコードページである．
              もし指定されていなければ，デフォルトで <code class="option">UTF8</code> になる．
              もし <code class="option">LOCALE</code> が指定されていて，
              システムが Unix locales をサポートしていれば，afpd はコードページを検出しようとし，
              afpd は検出したコードページを使って設定ファイルを読む．
              なので，ボリューム名やログインメッセージなどに拡張文字を使うことができる．
              <span class="citerefentry"><span class="refentrytitle">afp.conf</span>(5)</span> を参照のこと．</p></dd><dt><span class="term">mac charset<a id="idm533" class="indexterm"></a></span></dt><dd><p>既に述べたように，
              旧式の Mac OS クライアント（AFP 2.2 までのもの）は 
              afpd と通信するのにコードページを用いる．しかしながら，
              AFP プロトコルにはクライアントが使用しているコードページの折り合いをつけるというサポートはない．
              もしほかのどこかで指定されていないと，
              afpd は <span class="emphasis"><em>MacRoman</em></span> コードページが使われていると仮定する．
              クライアントが別のコードページ，
              例えば <span class="emphasis"><em>MacCyrillic</em></span> を使っていたならば, 
              それを明示的に設定<span class="bold"><strong>しなければならない</strong></span>だろう．
              <span class="citerefentry"><span class="refentrytitle">afp.conf</span>(5)</span> を参照のこと．</p></dd><dt><span class="term">vol charset<a id="idm546" class="indexterm"></a></span></dt><dd><p>これは afpd がディスク上のファイル名として使うべき charset を定義する．
              デフォルトでは <code class="option">unix
              charset</code> と同じである．もし <a class="ulink" href="http://www.gnu.org/software/libiconv/" target="_top">iconv</a><a id="idm553" class="indexterm"></a> がインストールしてあるならば，
                iconv が提供するキャラクターセットも使用することができる．</p><p>afpd はファイルを unix のファイルシステムに保存する時，
              拡張マッキントッシュキャラクター，
              あるいは unix のファイル名として不正なキャラクターを保持する手段が必要である．
              初期のバージョンでは，いわゆる CAP エンコーディング<a id="idm557" class="indexterm"></a>を使った．拡張キャラクター (&gt;0x7F) は :xx 
              の 16 進数に変換される．例えば，アップルのロゴ (MacRoman:
              0xF0) は :f0 として保存される．
              いくつかの特殊なキャラクターも :xx という表記に変換される．
              '/' は :2f にエンコードされる．
              もし， <code class="option">usedots</code> オプションが設定されていなければ，
              先頭のピリオド '.' は :2e にエンコードされる．</p><p>本ドキュメントでのバージョンではファイル名のデフォルトエンコーディングとして
              <code class="option">UTF8</code> を使っているにもかかわらず，'/' は ':' に変換される．
              欧米のユーザーにとって別の有用な設定として <code class="option">vol charset = ISO-8859-15</code> 
              もあり得る．</p><p>もし，あるキャラクターが <code class="option">mac charset</code> から選定した 
              <code class="option">vol charset</code> への変換ができない場合，マック上で -50 エラーを受け取るだろう．
              <span class="emphasis"><em>注意</em></span>：
              可能な限り常に，デフォルトの UTF8 ボリュームフォーマットにしてください．
                            <span class="citerefentry"><span class="refentrytitle">afp.conf</span>(5)</span> を参照のこと．</p></dd></dl></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="authentication"></a>認証<a id="idm573" class="indexterm"></a></h3></div></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm576"></a>AFP 認証の基本</h4></div></div></div><p>Apple は AFP クライアントとサーバー間の認証のために 
        "User Authentication Modules"
          <a id="idm579" class="indexterm"></a> (UAM) と呼ばれる柔軟なモデルを選んだ．
        AFP クライアントがまず最初に AFP サーバーと接続するとき，
        サーバーが提供している UAM のリストを問い合わせる．
        そして，クライアントがサポートしている最も強い暗号化の UAM を選ぶ．</p><p>数個の UAM は時間をかけて Apple が開発してものであり，
        サードパーティの開発者によるものもある．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm583"></a>Netatalk でサポートされている UAM</h4></div></div></div><p>Netatalk はデフォルトで以下のものをサポートしている：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>"No User Authent"<a id="idm589" class="indexterm"></a> UAM（ユーザー認証なしのゲスト接続）</p></li><li class="listitem"><p>"Cleartxt Passwrd"<a id="idm594" class="indexterm"></a> UAM（クリアテキスト(平文)パスワード，暗号化なし）</p></li><li class="listitem"><p>"Randnum exchange"<a id="idm599" class="indexterm"></a>，"2-Way Randnum exchange"<a id="idm602" class="indexterm"></a> UAM
            （乱数交換・双方向乱数交換，弱いパスワード暗号化，パスワードを別途保存する）</p></li><li class="listitem"><p>"DHCAST128"<a id="idm607" class="indexterm"></a> UAM（より強いパスワード暗号化）</p></li><li class="listitem"><p>"DHX2"<a id="idm612" class="indexterm"></a> UAM（DHCAST128 の後継版）</p></li></ul></div><p>他にもオプションとして以下のような UAM がある：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>"PGPuam 1.0"<a id="idm619" class="indexterm"></a><a id="idm622" class="indexterm"></a> UAM（Mac OS X 以前のクライアント用，PGP ベースの認証．
            これを動作させようとするには <a class="ulink" href="http://www.vmeng.com/vinnie/papers/pgpuam.html" target="_top">PGPuam
            クライアント</a>も別途必要である．</p><p>この UAM を有効にするためには，configure オプションに 
            <code class="filename">"--enable-pgp-uam"</code> を追加しなければならない．</p></li><li class="listitem"><p>"Kerberos IV"<a id="idm630" class="indexterm"></a><a id="idm633" class="indexterm"></a>/"AFS Kerberos"<a id="idm636" class="indexterm"></a> UAM
            （<a class="ulink" href="http://web.mit.edu/macdev/KfM/Common/Documentation/faq.html" target="_top">
            Kerberos v4 ベースの認証</a>で AFS ファイルサーバーを使用するのに適している）
            </p><p>この UAM を有効化するにはコンパイル時点で 
            <code class="filename">"--enable-krb4-uam"</code> オプションを使用する．</p></li><li class="listitem"><p>"Client Krb v2"<a id="idm644" class="indexterm"></a> UAM
            （Kerberos V，OS X で“シングルサインオン”環境には最も適当である――下記参照）</p><p><code class="filename">"--enable-krbV-uam"</code> 
            オプションでこの UAM を使用できるようになるであろう．</p></li></ul></div><p>"<code class="option">uam list</code>" を <code class="option">Global</code> 
        セクションで定義することによって，どの UAM を有効化すべきか設定できる．
        <span class="command"><strong>afpd</strong></span> はどの UAM を使っているのか，
        UAM を有効化した時に問題が起こっているのかどうかを， <code class="filename">netatalk.log</code> 
        あるいは起動時の syslog にログとして保存する．
        <span class="citerefentry"><span class="refentrytitle">asip-status.pl</span>(1)</span>  
        も AFP サーバーで有効な UAM の問い合わせをするのに使うことができる．</p><p>ある特定の UAM がサーバー上で有効であるということが，直ちに，
        クライアントもそれを使うことができるということを意味するわけではない．
        クライアント側でのサポートもまた必要である．
        Mac OS X 以前が使われている古いマッキントッシュでも，
        DHCAST128 のサポートは AppleShare クライアント 3.8.x 以降には存在している．</p><p>OS X では，
        AFP クライアントをもっと冗長にするクライアント側のテクニックがいくつかあるので，
        使用する UAM と折り合いをつけるまでに何が起こっているのか見ることができる．<a class="ulink" href="http://article.gmane.org/gmane.network.netatalk.devel/7383/" target="_top">このヒント</a>
        と比較してみるとよい．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm660"></a>どの UAM を有効にすべきか？</h4></div></div></div><p>第一義的には“何が必要か”と
        “サポートしようと考えている MAC OS のバージョンの種類”に依存する．
        基本的にはそのパスワード暗号化の強力さから，
        可能な限り DHCAST128 および DHX2 を試すべきである．</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>サーバーのボリュームに本当にゲストアクセスを供することが必要な場合以外は，
            "No User Authent" が無効化されているか確認すべきである．
            さもないと，意図しない権限のないアクセスを引き起こすことにもなる．
            ゲストアクセスを有効にしなければならない場合は，
            アクセスコントロールを使って，
            ボリューム各々についてゲストアクセスを有効化することを強制するように気を配るべきである．</p></li><li class="listitem"><p>"ClearTxt Passwrd" UAM 
            ではパスワードがネットワーク上を暗号化されずに伝わっていくので，
            字句そのまんまに良くない．
            クライアント側のみならずサーバー側でも無効にするよう務めるべきである．
            注意：もし NetBoot サービスを使用している Mac OS 8/9 にサービスを提供したい場合，
            cleartext.so の UAM が必要となる．
            これはそういった Mac のファームウエアに組み込まれた AFP クライアントがこうした基本的な形の認証しか扱わないためである．</p></li><li class="listitem"><p>"Randnum exchange" と "2-Way Randnum exchange" は 56 ビット DES 暗号化しか使わないので，
            これらもやはり回避すべきである．
            そしてなおかつ不利なのは，パスワードがサーバーに平文テキストとして保存されなければならないこと，
            および PAM 環境とも古典的な /etc/shadow とも統合がとれない
            （もしクライアントがこれらの UAM を使わなければならない場合，<span class="citerefentry"><span class="refentrytitle">afppasswd</span>(1)</span>
            ユーティリティを使って別途パスワードを管理しなければならない）という点である．</p></li><li class="listitem"><p>"DHCAST128" あるいは "DHX2" は PAM との統合と強力な暗号化とが組み合わせられているので，
            ほとんどの人々にとって良い妥協案であろう．</p></li><li class="listitem"><p>Kerberos V<a id="idm677" class="indexterm"></a> 
            ("Client Krb v2") UAM を用いれば，
            Kerberos チケットを用いて真のシングルサインオン環境を実装することが可能である．
            パスワードがネットワークを通して送られることもない．
            その代わり，ユーザーのパスワードは appleshare サーバーへのサービスチケットを暗号から復号するのに用いられる．
            サービスチケットにはクライアントの暗号鍵と幾らかの暗号化されたデータが含まれる
            （それは appleshare サーバーだけが復号できる）．
            サービスチケットの暗号化された部分がサーバーに送られ，ユーザーを認証するのに使われる．
            afpd サービスプリンシパル検知の実装の仕方のために，この認証方法は中間者攻撃に対して脆弱である．</p></li></ul></div><p>様々な UAM の技術的実装についてのより詳細な概要については，Apple の <a class="ulink" href="http://developer.apple.com/library/mac/#documentation/Networking/Conceptual/AFP/AFPSecurity/AFPSecurity.html#//apple_ref/doc/uid/TP40000854-CH232-SW1" target="_top">File
        Server Security</a> ページを見ていただきたい．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm682"></a>特定の UAM で別の認証ソースを使う</h4></div></div></div><p>いくつかの UAM は別の認証“バックエンド”を使えるようにしてある．
        いわゆる <code class="filename">uams_cleartext.so</code>，
        <code class="filename">uams_dhx.so</code> 及び
        <code class="filename">uams_dhx2.so</code>である．これらは
        <code class="filename">/etc/passwd</code> 
        (<code class="filename">/etc/shadow</code>) からの古典的 Unix パスワードでも，
        システムがサポートしていれば　PAM でもどちらでも使うことができる．
        <code class="filename">uams_cleartext.so</code> は <code class="filename">uams_passwd.so</code> ないしは
        <code class="filename">uams_pam.so</code> へのシンボリックリンクとして，
        <code class="filename">uams_dhx.so</code> は <code class="filename">uams_dhx_passwd.so</code> ないしは
        <code class="filename">uams_dhx_pam.so</code> へのシンボリックリンクとして，さらには
        <code class="filename">uams_dhx2.so</code> は <code class="filename">uams_dhx2_passwd.so</code> ないしは
        <code class="filename">uams_dhx2_pam.so</code>へのシンボリックリンクとすることができる．</p><p>なので，もし Netatalk の UAM フォルダー（デフォルトで 
        <code class="filename">/etc/netatalk/uams/</code>）が以下のようであれば：
        </p><pre class="programlisting">uams_clrtxt.so -&gt; uams_pam.so
uams_dhx.so -&gt; uams_dhx_pam.so
uams_dhx2.so -&gt; uams_dhx2_pam.so</pre><p>
        PAM さもなくば古典的な Unix パスワードを使用しているわけである．
        PAM を使用することで最も有利なのは，
        例えば LDAP 経由，あるいは NIS 経由などの集約した認証環境に Netatalk を統合できることである．
        そのような環境でのユーザーのログイン資格情報 (credentials) の保護は，
        UAM そのものが供している暗号化の強さにもまた依存している．
        ということを常に念頭においていただきたい．
        なので，"ClearTxt Passwrd" や "Randnum exchange" のような弱い UAM をネットワーク上から
        完全に除去することを考えるべきである．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm702"></a>Netatalk UAM を概要表</h4></div></div></div><p>最も一般的に用いられる UAM の概観．</p><div class="table"><a id="idm705"></a><p class="title"><strong>表3.1 Netatalk UAM 概観</strong></p><div class="table-contents"><table class="table" summary="Netatalk UAM 概観" border="1"><colgroup><col align="center" class="col1" /><col align="center" class="uam_guest" /><col align="center" class="uam_clrtxt" /><col align="center" class="uam_randnum" /><col align="center" class="uam_dhx" /><col align="center" class="uam_dhx2" /><col align="center" class="uam_gss" /></colgroup><tbody><tr><td align="center" valign="middle">UAM</td><td align="center">No User Authent<a id="idm719" class="indexterm"></a></td><td align="center">Cleartxt Passwrd<a id="idm723" class="indexterm"></a></td><td align="center">(2-Way) Randnum exchange<a id="idm727" class="indexterm"></a></td><td align="center">DHCAST128<a id="idm731" class="indexterm"></a></td><td align="center">DHX2<a id="idm735" class="indexterm"></a></td><td align="center">Client Krb v2<a id="idm739" class="indexterm"></a></td></tr><tr><td align="center" valign="middle">パスワード長</td><td align="center">ゲストアクセス</td><td align="center">最大 8 文字</td><td align="center">最大 8 文字</td><td align="center">最大 64 文字</td><td align="center">最大 256 文字</td><td align="center">Kerberos チケット</td></tr><tr><td align="center" valign="middle">サポートするクライアント</td><td align="center">全ての Mac OS のバージョンで組み込み済</td><td align="center">10.0 を除く全ての Mac OS のバージョンで組み込み済．
                最近のバージョンでは明示的にアクティブ化する必要がある．</td><td align="center">ほとんど全ての Mac OS のバージョンで組み込み済</td><td align="center">AppleShare クライアント 3.8.4 より組み込み済で，
                3.8.3 では Mac OS X の AFP クライアントに統合したプラグインとしての用意あり．</td><td align="center">Mac OS X 10.2 より組み込み済</td><td align="center">Mac OS X 10.2 より組み込み済</td></tr><tr><td align="center" valign="middle">暗号化</td><td align="center">クライアント・サーバー間で認証なくゲストアクセス可能．</td><td align="center">パスワードがネットワーク上を暗号化されずに伝わっていく．
                字句そのままに悪いので，可能ならば全面的に使用を回避すべき
                （注意：NetBoot サービスの提供には ClearTxt UAM が必要）</td><td align="center">DES, 56 ビットに相当する 8 バイトの乱数がネットワーク上に送出．
                オフラインの辞書攻撃に対して脆弱．
                パスワードがサーバー上で平文であることが求められる．</td><td align="center">パスワードは 128 ビット SSL で暗号化され，
                ユーザーはサーバーに認証されるが，“逆もまた真”ではない．
                このため中間者攻撃に対して弱い．</td><td align="center">パスワードは libgcrypt の CAST 128，CBC モードを用いて暗号化される．
                ユーザーはサーバーに認証されるが，“逆もまた真”ではない．
                このため中間者攻撃に対して弱い．</td><td align="center">パスワードがネットワークを通して送られることがない．
                サービスプリンシパル検知の方法が原因で，
                この認証方法は中間者攻撃に対して脆弱である．</td></tr><tr><td align="center" valign="middle">
                サーバーがサポートする共有オブジェクト
                </td><td align="center" valign="middle">uams_guest.so</td><td align="center" valign="middle">uams_cleartxt.so</td><td align="center" valign="middle">uams_randnum.so</td><td align="center" valign="middle">uams_dhx.so</td><td align="center" valign="middle">uams_dhx2.so</td><td align="center" valign="middle">uams_gss.so</td></tr><tr><td align="center" valign="middle">パスワードの保管方法</td><td align="center" valign="middle">なし</td><td align="center" valign="middle">/etc/passwd (/etc/shadow) 
                ないしは PAM</td><td align="center" valign="middle">
                パスワードは別のテキストファイルに平文として保存される
                </td><td align="center" valign="middle">/etc/passwd (/etc/shadow) 
                ないしは PAM</td><td align="center" valign="middle">/etc/passwd (/etc/shadow) 
                ないしは PAM</td><td align="center" valign="middle">Kerberos キー配布センター*</td></tr></tbody></table></div></div><br class="table-break" /><p>* <a class="ulink" href="http://cryptnet.net/fdp/admin/kerby-infra/en/kerby-infra.html" target="_top">Kerberos
        概要</a> も一読のこと</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="sshtunnel"></a>SSH トンネリング</h4></div></div></div><p>トンネリングや VPN のたぐいのもの全ては，
        AFP 認証や UAM に関してすべきことは概ね皆無である．
        しかしながらアップルが「SSHを用いて安全な接続を可能にする」というオプションを導入して以来，
        多数の人が両者について混乱する傾向にある．以下ではその点についても述べる．</p><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="manualsshtunnel"></a>手動で AFP セッションをトンネリング</h5></div></div></div><p>これは，
          "AFP over TCP" を“話すことができる”最初の AFP サーバーがネットワークに登場して以来うまく動作する．
          リモートサーバーの AFP ポートをローカルの 548 番以外の異なるポートにトンネルし，
          その後ローカルでこのポートににつなげるだけである．OS X では以下のようにすればよい．</p><pre class="programlisting">ssh -l $USER $SERVER -L 10548:127.0.0.1:548 sleep 3000</pre><p>トンネルを確立したならば，
          “サーバーに接続”ダイアログで <code class="filename">"afp://127.0.0.1:10548"</code> 
          を使うことができる．
          ローカルの AFP クライアントは Mac のローカル 10548 番ポートに接続し，
          そのポートは SSH を通してリモートサーバーの AFP ポート（デフォルトでは 548 番を使う）に転送されているので，
          端緒の接続試行も含めて全ての AFP トラフィックがネットワークを暗号化されて送られる．</p><p>この手のトンネルは，もし，“真の” VPN を使えないが，インターネットを通じて，
          弱い認証機構しかない AFP サーバーにアクセスしなければならない場合の理想的な解決手段である．
          <span class="command"><strong>ssh</strong></span> の "-C" オプションでデータ圧縮が可能であり，
          トンネルの端点を AFP クライアント，サーバーどちらとも異なるようにすることが可能である
          （詳細については SSH のドキュメントと比較してほしい）という点に留意すべきである．</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="autosshtunnel"></a>自動的にトンネル AFP 接続を確立する</h5></div></div></div><p>Apple は Mac OS X 10.2 から 10.4 で，
          「サーバーに接続」ダイアログに
          「SSHを用いて安全な接続を可能にする」チェックボックスを追加した．
          この考えの裏にあるのは：サーバーが SSH で接続できるというサインを出した時，
          Mac OS X の AFP クライアントはトンネルを確立しようとし，
          自動的に全ての AFP トラフィックをこのトンネルを通して送る．ということなのである．</p><p>しかし，この機能が初めて…部分的に，
          動作するようになるのに Mac OS X 10.3 までかかった．
          SSH トンネルが確立できない時，
          AFP クライアントは<span class="strong"><strong>何の通知もなく</strong></span>暗号化していない 
          AFP 接続試行にフォールバックした．</p><p>"<code class="option">advertise ssh</code>" および 
          "<code class="option">fqdn</code>" オプション両方を <code class="option">Global</code> 
          セクションで設定（設定を変更したら，afpd を再起動した後 <span class="citerefentry"><span class="refentrytitle">asip-status.pl</span>(1)</span> で二重チェックするべき）した時は，
          SSH トンネルした AFP リクエストの扱いが可能であることを Netatalk の afpd はレポートする．
          しかし，このオプションを決して使用したくなくなる２，３の理由がある：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>（SSH がするように）TCP over TCP のトンネリングは最良の案ではない．
              IP レイヤーに基づいた VPN などのより良い解決法が存在する．</p></li><li class="listitem"><p>このように SSH でその場をしのぐことは AFP 認証機構に直接統合された通常の 
              UAM ではないし，
              代わりにこの方法では，
              トンネルの確立を<span class="strong"><strong>試行
              </strong></span>できるのかどうなのかのサインをクライアントに送るために，
              単一のフラグを用いる．
              このため，何かがおかしい時に何が起こっているのかを見ようとする気を失ってしまう．</p></li><li class="listitem"><p>全ての接続試行は localhost から行われているように見えるので，
              <span class="command"><strong>macusers</strong></span> のような Netatalk ツールによって，
              どのマシンがログオンしているのか制御ができない．</p></li><li class="listitem"><p>一方，AFP セッション全てが SSH で暗号化されていることを確実にしたい場合は，
              afpd へのアクセスを localhost のみ（TCP ラッパー）に制限すべきである．
              あるいは…</p></li><li class="listitem"><p>…10.2 から 10.3.3 を使っている場合は，予想とは逆に：
              トンネルの確立に失敗したという通知一つもなく，
              ネットワーク上で暗号化されていない AFP の通信（ログイン資格情報を含む）が起こりえるということである．
              Apple は Mac OS X 10.3.4 になってそれをはじめて修正した．</p></li><li class="listitem"><p>SSH 経由で全ての AFP セッションを暗号化するることは，
              Netatalk サーバーの負荷の著しい上昇を招く可能性がある</p></li></ul></div></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="acls"></a>ACL のサーポート<a id="idm824" class="indexterm"></a></h3></div></div></div><p>afp の ACL サポートは Solaris の ZFS ACL，派生したプラットフォーム，そして，
      Linux の POSIX 1e ACL で実装されている．</p><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm827"></a>環境設定</h4></div></div></div><p>基本的な方式で運用するならば設定することは何もない．
        Netatalk は ACL をオンザフライで読み込み，そののちいわゆる UARights<a id="idm830" class="indexterm"></a> パーミションビット経由で AFP クライアントに送られる有効なパーミッションを算出する．
        マック上では，これらのビットを Finder ウィンドウ内のパーミッションと調整するために Finder が使用する．
        例：UNIX のモードでは書き込み専用だが ACL がユーザーに書き込み権限を与えているフォルダーは有効な読み書き権限を表示する．
        権限のマッピングなしに Finder は読み込み専用アイコンを表示するだろうし，
        ユーザーはそのフォルダーに書き込みはできないであろう．</p><p>デフォルトでは，認証ユーザーに有効なパーミションは UNIX のモードではなく，
        前記 UARights<a id="idm833" class="indexterm"></a> の機構のみに対応付けられる．
        この挙動は設定オプション <a class="link" href="afp.conf.5.html#map_acls">map acls</a> で修正することができる．</p><p>しかしながら，Finder の“情報を見る”ウィンドウでもターミナルでも，
        ACL を見ることは不可能で，そこで見ているのは OS X で ACL がどのように設計されたのかという結果である．
        もしクライアント上でも ACL を表示させたいと思うならば，諸々を認証ドメイン（ディレクトリサービス，
        例えば，LDAP やOpenDirectory）の一部と，より内包されているようにして，
        クライアント側でもサーバー側でもセットアップをおこなうべきである．
        その理由は，OS X ACL が ただ，uid と gid だけでなく UUID と紐付いているためである．
        このため，afpd は全てのファイルシステムの uid と git を UUID に紐付けできなければならない．
        そうすれば， afpd は OS X の UUID に紐付けた UNIX uid と gid も含めたサーバー側の ACL を返すことができる．
        </p><p>Netatalk は LDAP クエリーを使ってディレクトリサーバーに問い合わせができる．
        ディレクトリサーバー（Active Directory，Open Directory）が既にユーザーとグループの UUID 属性を提供している．
        あるいはディレクトリサーバー（例えば 
        OpenLDAP）に使用されていない属性を再利用する（あるいは新たに追加する）のいずれかである．</p><p>より踏み込むと：</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>ZFS を使っている Solarisの ZFS ボリュームごとに対して，</p><p>Netatalk を使用したいと思っているあらゆるボリュームを
            ZFS ACL がわかるように構成すべきである：</p><pre class="screen">aclinherit = passthrough
aclmode = passthrough</pre><p>このひとひねりが何をするのか，どのように適用するのか，についての説明は，
            ホストの ZFS ドキュメンテーション（例えば man zfs）を確認のこと．</p></li><li class="listitem"><p>認証ドメイン</p><p>サーバーとクライアントがセキュリティ連携の一部となっていて，
            ユーザー id データは共通のソースから出てこなければならない．
            Darwin の ACL は UUID に基づいている．
            なので，AFP 3.2 での ACL の仕様は Darwin の ACL である．
            故に id データのソースは全てのユーザーとグループの属性を提供できなければならない．
            ここで UUID は ASCII テキストとして保管されている．言い換えれば：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>UUID を何らかの属性に保管している場合は 
                Open Directory サーバーないしは LDAP サーバーが必要である．</p></li><li class="listitem"><p>クライアントはこのサーバーを使用するように構成されていなければならない．</p></li><li class="listitem"><p>サーバーは nsswitch と PAM 経由で使用されるよう構成しなければならない．</p></li><li class="listitem"><p>Netatalk が LDAP 検索クエリでユーザーとグループの UUID を引き出せるように，
                <a class="link" href="afp.conf.5.html" title="afp.conf">afp.conf</a> 内で <a class="link" href="afp.conf.5.html#acl_options" title="ACL処理のためのオプション">ACL 専用のオプションを</a>使って Netatalk を設定しなければならない．</p></li></ul></div></li></ol></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm859"></a>OS X の ACL</h4></div></div></div><p>アクセス制御リスト (ACL) と共に，
        Mac OS X は正統的な UNIX のパーミッションモデルの有力な拡張を提案した．
        ACL は，
        所定のユーザーあるいはグループのパーミッションのセットを明示的に許可したり拒否するアクセス制御エントリー 
        (ACE) の番号つきリストである．</p><p>ユーザー ID，またはグループ ID と紐付いている UNIX パーミッションとは異なり，
        ACL は UUID と紐付いている．この理由により，あるオブジェクトの ACL にアクセスすると，
        サーバーとクライアントは，UUID と ユーザー／グループ ID 間の変換をしてくれる，
        共通のディレクトリサービスを使うことを要求される．</p><p>ACL と UNIX のパーミションの相互関係は比較的シンプルなものである．
        ACL はオプションなので，UNIX パーミションはアクセス制御のデフォルトのメカニズムの役割をする．
        オブジェクトの UNIX パーミションを変更しても ACL は手付かずのままで，
        ACL の修正でもオブジェクトの UNIX パーミションは決して変更されない．アクセスチェックの間，
        OS X は最初に以下の順序で ACE の評価をして，オブジェクトの ACL を検査する：
        全てのリクエスト権限が許可されるまで，リクエストされた権限が ACE によって明示的に拒否された，
        あるいはリストの最後までたどり着いた．である．ACL がない，
        あるいは ACL に許可されたパーミションがリクエストを実行するのに十分でない場合，
        OS X は次にオブジェクトの UNIX パーミションの評価に入る．
        つまり，ACL は常に UNIX のパーミションより優先順位が上位ということである．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm864"></a>ZFS の ACL</h4></div></div></div><p>ZFS の ACL はほぼ OS X の ACL に匹敵するものである．
        両者ともほぼ同一の良い粒度のパーミションと設定の継承が提供されている．</p></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm867"></a>POSIX の ACL</h4></div></div></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idm869"></a>概要</h5></div></div></div><p>OS X あるいは NFSv4 の ACL と比較すると，Posix ACL は，
          伝統的な UNIX パーミションの制限を打開するには異質で汎用性のないアプローチを表現している．
          実装は Posix 標準を取り込んだものを基礎としている．</p><p>Posix 1003.1e 標準では二つのタイプの ACL を定義している．
          ファイルとディレクトリは，
          アクセスチェックのために問い合わせを受けるアクセス ACL を保持することができる．
          ディレクトリはアクセスチェックには向いていないデフォルトの ACL も保持することができる．
          デフォルトの ACL 付きでディレクトリの内側に新規オブジェクトが作成された時，
          デフォルトの ACL はそれがアクセス ACL であるものとして新規オブジェクトに適用される．
          サブディレクトリは親ディレクトリのデフォルト ACL を継承する．
          継承制御にそれ以上のメカニズムは何もない．</p><p>設計上，Posix ACL と OS X 間の違いに含まれている特筆すべき点は：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>パーミションモデルは何も細分化されていない．
                UNIX のパーミション同様，Posix ACL は読み込み，書き込み，そして実行権限を区別している．</p></li><li class="listitem"><p>ACL 内のエントリーに順序はない．</p></li><li class="listitem"><p>Posix ACL は権限を許可することしかできない．
                エントリーから権限を明示的に拒否する手立てはない．</p></li><li class="listitem"><p>UNIX パーミションは特別なエントリーとして ACL に統合されている．</p></li></ul></div><p>Posix 1003.1e は 6 つの異なるタイプの ACL エントリーを定義している．
          前半の 3 つは標準の UNIX パーミションを統合するのに用いられている．
          これらは ACL として最小限の形であり，存在することは必須であり，
          そして各々のタイプにつきたった一つのエントリーだけが ACL 内に許される．</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ACL_USER_OBJ：所有ユーザー（オーナー）のアクセス権限．</p></li><li class="listitem"><p>ACL_GROUP_OBJ：所有グループ（オーナーグループ）のアクセス権限．</p></li><li class="listitem"><p>ACL_OTHER：あらゆるユーザー・グループに対するアクセス権限．</p></li></ul></div><p>残りのエントリーのタイプは伝統的パーミションモデルの拡張である：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ACL_USER：あるユーザーに対するアクセス権を許可する．</p></li><li class="listitem"><p>ACL_GROUP：あるグループに対するアクセス権を許可する．</p></li><li class="listitem"><p>ACL_MASK：ACL_GROUP_OBJ，ACL_USER および ACL_GROUP 
                タイプのエントリーで許可されうるアクセス権の最大値を制限する．名前の示すように，
                このエントリーはマスクとして働く．一つの ACL あたり一個だけの ACL_MASK エントリーが許される．
                もし ACL に，ACL_USER ないしは ACL_GROUP エントリーが含まれているのであれば，
                ACL_MASK エントリーも存在しなければならない．さもなくば，ACL_MASK はオプションである．</p></li></ul></div><p>ACL を意識していないアプリケーションとの互換性を維持のため，
          Posix 1003.1e は，オブジェクトの UNIX 
          パーミションを検索したり処理するシステムコールやユーティリティーのセマンティクスを変える．
          オブジェクトが必要最低限の ACL のみ保持している場合，
          UNIX パーミションのグループパーミションビットは ACL_GROUP_OBJ エントリーの値に対応する．</p><p>しかしながら，もし ACL に ACL_MASK エントリーが含まれている場合，
          上記システムコールやユーティリティーの挙動は異なるものとなる．
          UNIX パーミションのグループパーミションビットは ACL_MASK エントリーの値に対応する，
          すなわち，"chmod g-w" の呼び出しは，グループに対する書き込みアクセスを無効にするだけでなく，
          ACL_USER ないしは ACL_GROUP 
          エントリーによって許可されていた書き込みアクセスのエンティティ全てを無効にするのである．</p></div><div class="sect4"><div class="titlepage"><div><div><h5 class="title"><a id="idm904"></a>POSIX ACL から OSX の ACL へのマッピング</h5></div></div></div><p>クライアントがオブジェクトの ACL を読み込もうとした時，
          afpd は Posix ACL からそれに等価な OS X の ACL にマップする．
          オブジェクトの ACL の書き込みには afpd が OS X の ACL を Posix ACL にマップすることが要求される．
          Posix ACL の設計上の制約から，
          マッピングを経た結果がオリジナルの ACL 
          のセマンティクスと概ね同じになるような正確なマッピングを見出すことは通常不可能である．</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>afpd はパーミション一式を拒否したエントリーを通告なしに破棄する．
                これは Posix の設計では表現する手立てがないためである．</p></li><li class="listitem"><p>Posix ACL ではエントリーが順序付きではないので，順序を保管するのは不可能である．</p></li><li class="listitem"><p>継承制御もまた厳しい制限を受けやすい：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>only_inherit フラグが設定されたエントリーはディレクトリのデフォルト 
                      ACL の一部にしかならない．</p></li><li class="listitem"><p>少なくとも file_inherit，directory_inherit ないしは limit_inherit 
                      のうち一つが設定されたエントリーはディレクトリアクセスとデフォルト ACL の一部分となる．
                      しかし継承に課せられた制約は無視される．</p></li></ul></div></li><li class="listitem"><p>Posix 側により細分化されたパーミションモデルがないことで，
                結果としては通常は許可されるパーミションが増えるという結果になる．</p></li></ul></div><p>OS X クライアントは Posix 1003.1e 特有の UNIX パーミションと ACL_MASK との関係を意識していないので，
          afpd は互換性問題を回避するためにこの機能をクライアントに公開せず，
          そして afpd は *unix パーミションと ACL をアップルの AFP 
          用リファレンス実装がするのと同じ方法で扱う．
          オブジェクトの UNIX パーミションがリクエストされた時，afpd は適切なグループ権限を算出し，
          FPUnixPrivs 構造の "permissions" と "ua_permissions" 
          要素を介し，オーナーおよび全ての者のアクセス権限も共に付して，リクエストした側に結果を返す．
          （Apple Filing Protocol Reference の 181 ページ参照）
          オブジェクトのパーミションを変更すると，afpd は常に ACL_USER_OBJ，ACL_GROUP_OBJ および ACL_OTHERS を更新する．
          もし ACL_MASK エントリーも存在すれば，新しいグループの権限が有効になり，かつ，
          既存の ACL_USER あるいは ACL_GROUP 型のエントリーは手付かずになるような ACL_MASK の値の再計算を afpd が行う．</p></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="fce"></a>ファイルシステム変更イベント<a id="idm925" class="indexterm"></a></h3></div></div></div><p>Netatalk には素敵なファイルシステム変更イベント機構が含まれている．ここで，
      afpd プロセスは，なにがしかのファイルシステムイベントについて，関心を寄せているリスナーに，
      UDP ネットワークデータグラム経由で通知する．</p><p>この UDP パケットのフォーマットについて，また，
      これらをリスナー内でどのように使用するかのデモを試してみる C アプリケーションの実例については，
      Netatalk のソースファイル <code class="filename">bin/misc/fce.c</code> に目を通していただきたい．</p><p>現在サポートされている FCE （ファイルシステム変更イベント：Filesystem Change Events）は以下である：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>ファイル変更：file modification (fmod)</p></li><li class="listitem"><p>ファイル削除：file deletion (fdel)</p></li><li class="listitem"><p>ディレクトリ削除：directory deletion (ddel)</p></li><li class="listitem"><p>ファイル作成：file creation (fcre)</p></li><li class="listitem"><p>ディレクトリ削除：directory deletion (ddel)</p></li></ul></div><p>利用可能で基本的な設定オプションの詳細については  <code class="filename"><a class="link" href="afp.conf.5.html#fceconf" title="ファイルシステム変更イベント (FCE)">afp.conf</a></code> に目を通していただきたい．</p></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm945"></a>Spotlight<a id="idm947" class="indexterm"></a></h2></div></div></div><p>バージョン 3.1 から，Netatalk は Spotlight 検索をサポートしている．
    Netatalk はメタデータの保存，インデックス化およびサーチエンジンに Gnome
    <a class="ulink" href="https://projects.gnome.org/tracker/" target="_top">Tracker</a> を用いる．</p><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm951"></a>設定</h3></div></div></div><p><code class="option">spotlight</code> オプションを使って，
      グローバルで，あるいは，ボリューム単位ごとに Spotlight とインデックス化を有効にできる．</p><div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">警告</h3><p>一旦 Spotlight をどこか単一のボリュームで有効にすると，
        Spotlight が無効にされたことになるその他全てのボリュームでは全く検索できないようになる．</p></div><p>The <span class="command"><strong>dbus-daemon</strong></span> バイナリは Spotlight 機能のためにインストールしなければならない．
      dbus-daemon へのパスは "configure" の --with-dbus-daemon オプションで決定する．</p><p><span class="command"><strong>dbus-daemon</strong></span> バイナリが，他のパスにインストールされている場合，
      パスを指示するためにグローバルオプション <code class="option">dbus daemon</code> を用いなければならない．
      例えば Solaris 上で OpenCSW 由来の Tracker を用いている場合は以下のようにする：
      </p><pre class="screen">dbus daemon = /opt/csw/bin/dbus-daemon</pre></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm963"></a>制限と注意</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>大きいファイルシステム</p><p>Linux 上の Tracker はファイルシステム変更の追跡に inotify 
          カーネルファイルシステム変更イベント API を使用する．大きなファイルシステムではこれが問題になりやすい．
          なぜなら，この inotofy API は再帰的ディレクトリ監視を提供してはおらず，
          代わりにあらゆるサブディレクトリの監視が各々で追加されなければならないということを要求してくるからである．</p><p>Solaris ではファイルイベント通知（FEN: File Event Notification) が用いられる．
          この Solaris のサブシステムではどんな制限とリソース消費があるのか不明である．</p><p>それ故，ライブでのファイルシステム監視は無効にして，
          その代わりに定期的に Tracker にファイルシステム変更のスキャンを行わせることを推奨する．
          下記 Tracker オプション，<a class="link" href="configuration.html#enable-monitors">enable-monitors</a> および <a class="link" href="configuration.html#crawling-interval">crawling-interval</a> を参照のこと．</p></li></ul></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm973"></a>サーバー上での Tracker コマンドラインツールの使用</h3></div></div></div><p>Netatalk は動作中でなければならず，コマンドの実行は root 権限で行わなければならない．
      そしていくつかの環境変数を設定されなければならない（PREFIX は Netatalk 
      をインストールしたベースディレクトリにあわせて読み替える）：</p><pre class="screen">$ su
# cat .tracker_profile
PREFIX="/"
export XDG_DATA_HOME="$PREFIX/var/netatalk/"
export XDG_CACHE_HOME="$PREFIX/var/netatalk/"
export DBUS_SESSION_BUS_ADDRESS="unix:path=$PREFIX/var/netatalk/spotlight.ipc"
# . .tracker_profile
#
</pre><p>OpenCSW の Tracker を使用していたら PATH 
      も以下のように更新する：</p><pre class="screen"># export PATH=/opt/csw/bin:$PATH</pre><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm979"></a>Tracker の状態の問い合わせ</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">最近の Tracker:</span></dt><dd><pre class="screen"># tracker daemon</pre></dd><dt><span class="term">古い Tracker:</span></dt><dd><pre class="screen"># tracker-control -S</pre></dd></dl></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm990"></a>Tracker の停止</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">最近の Tracker:</span></dt><dd><pre class="screen"># tracker daemon -t</pre></dd><dt><span class="term">古い Tracker:</span></dt><dd><pre class="screen"># tracker-control -t</pre></dd></dl></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm1001"></a>Tracker の開始</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">最近の Tracker:</span></dt><dd><pre class="screen"># tracker daemon -s</pre></dd><dt><span class="term">古い Tracker:</span></dt><dd><pre class="screen"># tracker-control -s</pre></dd></dl></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm1012"></a>ディレクトリの再インデックス</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">最近の Tracker:</span></dt><dd><pre class="screen"># tracker index -f PATH</pre></dd><dt><span class="term">古い Tracker:</span></dt><dd><pre class="screen"># tracker-control -f PATH</pre></dd></dl></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm1023"></a>Tracker にファイルやディレクトリの情報を問い合わせる</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">最近の Tracker:</span></dt><dd><pre class="screen"># tracker info PATH</pre></dd><dt><span class="term">古い Tracker:</span></dt><dd><pre class="screen"># tracker-info PATH</pre></dd></dl></div></div><div class="sect3"><div class="titlepage"><div><div><h4 class="title"><a id="idm1034"></a>Tracker で検索</h4></div></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">最近の Tracker:</span></dt><dd><pre class="screen"># tracker search QUERY</pre></dd><dt><span class="term">古い Tracker:</span></dt><dd><pre class="screen"># tracker-search QUERY</pre></dd></dl></div></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm1045"></a>Tracker コマンドラインのより進んだ設定</h3></div></div></div><p>Tracker はその設定を Gnome dconf バックエンド経由で保管し，
      これ <span class="command"><strong>gsettings</strong></span> コマンドで変更できる．</p><p>Gnome dconf の設定は各々のユーザーベースである．よって，Netatalk
      は Tracker プロセスを root 権限で実行するため，設定は root 
      ユーザーのコンテキストで保管され，これら設定の読み込み書き込みも root 
      権限で行われ，Netatalk 
      はこのとき動作中でなければならない．（そして繰り返しになるが，環境を前記のように設定しなければならない）</p><pre class="screen"># gsettings list-recursively | grep Tracker
org.freedesktop.Tracker.Writeback verbosity 'debug'
...</pre><p>以下のリストで Tracker
      の一部重要なオプションおよびそのデフォルト設定について示す．</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">org.freedesktop.Tracker.Miner.Files
          index-recursive-directories</span></dt><dd><p>このオプションは Tracker がどのディレクトリをインデックス化するかを制御する．
            本オプションは Netatalk ボリュームそれぞれの <code class="option">Spotlight</code> 
            オプションの設定を反映して自動的に Netatalk によってセットされるので，手動で変更してはならない．</p></dd><dt><span class="term"><a id="enable-monitors"></a>org.freedesktop.Tracker.Miner.Files
          enable-monitors <em class="parameter"><code> true</code></em></span></dt><dd><p>この値は Tracker が全ての設定パスの変更を監視するかどうかを制御する．
            ファイルシステムの変更バックエンド（Linux なら FAM，Solaris なら FEN）に依存しているので，
            この機能は期待するほどの信頼度をもって動作しないかもしれない．
            それ故，この機能は無効にして代わりに Tracker 自体の定期的なクローリングに頼るほうが安全であろう．
            オプション <code class="option">crawling-interval </code> も参照のこと．</p></dd><dt><span class="term"><a id="crawling-interval"></a>org.freedesktop.Tracker.Miner.Files
          crawling-interval <em class="parameter"><code>-1</code></em></span></dt><dd><p>ファイルシステムがデータベース上で最新であるかチェックする間隔（日にち単位）．
            最大は 365 まで，デフォルトでは -1，-2 = クローリングは完全に行われない．
            -1 = スタートアップ時にクローリングが行われる“はず”（シャットダウンが完全でなかった場合）．
            0 = 強制的にクローリングされる</p></dd></dl></div></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm1070"></a>サポートされているメタデータ属性</h3></div></div></div><p>下記表にサポートされている Spotlight メタデータ属性を挙げる．</p><div class="table"><a id="idm1073"></a><p class="title"><strong>表3.2 サポートされている Spotlight メタデータ属性</strong></p><div class="table-contents"><table class="table" summary="サポートされている Spotlight メタデータ属性" border="1"><colgroup><col /><col /></colgroup><thead><tr><th align="center">内容</th><th align="center">Spotlight キー</th></tr></thead><tbody><tr><td>名前</td><td>kMDItemDisplayName, kMDItemFSName</td></tr><tr><td>ドキュメントの内容（全文検索）</td><td>kMDItemTextContent</td></tr><tr><td>ファイルタイプ</td><td>_kMDItemGroupId, kMDItemContentTypeTree</td></tr><tr><td>ファイル修正日付</td><td>kMDItemFSContentChangeDate,
              kMDItemContentModificationDate,
              kMDItemAttributeChangeDate</td></tr><tr><td>ファイルの内容の作成された日付</td><td>kMDItemContentCreationDate</td></tr><tr><td>ファイルの内容の著者・作成者</td><td>kMDItemAuthors, kMDItemCreator</td></tr><tr><td>ファイルが作成された国の名前</td><td>kMDItemCountry</td></tr><tr><td>期間</td><td>kMDItemDurationSeconds</td></tr><tr><td>総ページ数</td><td>kMDItemNumberOfPages</td></tr><tr><td>ドキュメントのタイトル</td><td>kMDItemTitle</td></tr><tr><td>コンテンツの幅（ピクセル）：例えば，画像ならばピクセル幅，動画ならばフレームの幅</td><td>kMDItemPixelWidth</td></tr><tr><td>コンテンツの高さ（ピクセル）：例えば，画像ならばピクセルでの高さ，動画ならばフレームの高さ</td><td>kMDItemPixelHeight</td></tr><tr><td>ドキュメント内コンテンツで使用されている色空間モデル</td><td>kMDItemColorSpace</td></tr><tr><td>サンプルあたりのビット値（訳注：分解能，量子化ビット数，色深度など）</td><td>kMDItemBitsPerSample</td></tr><tr><td>レンズの焦点距離（ミリメートル）</td><td>kMDItemFocalLength</td></tr><tr><td>ISO 感度</td><td>kMDItemISOSpeed</td></tr><tr><td>ドキュメントの向き．許容される値は 0（ランドスケープ：横向き）と 1 （ポートレイト：縦向き）</td><td>kMDItemOrientation</td></tr><tr><td>水平解像度（DPI）</td><td>kMDItemResolutionWidthDPI</td></tr><tr><td>垂直解像度（DPI）</td><td>kMDItemResolutionHeightDPI</td></tr><tr><td>シャッタースピード（秒）</td><td>kMDItemExposureTimeSeconds</td></tr><tr><td>オーディオファイルに含まれている曲の作曲者</td><td>kMDItemComposer</td></tr><tr><td>歌あるいは楽曲の音楽ジャンル</td><td>kMDItemMusicalGenre</td></tr></tbody></table></div></div><br class="table-break" /></div><div class="sect2"><div class="titlepage"><div><div><h3 class="title"><a id="idm1147"></a>参考</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><a class="ulink" href="https://developer.apple.com/library/mac/#documentation/Carbon/Reference/MDItemRef/Reference/reference.html" target="_top">MDItem</a></p></li><li class="listitem"><p><a class="ulink" href="https://live.gnome.org/Tracker/Documentation" target="_top">Tracker</a></p></li></ol></div></div></div><div class="sect1"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="idm1156"></a>Netatalk の起動と停止</h2></div></div></div><p>Netatalk の配布物は，
    いくつかのオペレーティングシステム固有のスタートアップ・スクリプト・テンプレートを備えている．
    これらテンプレートは，コンパイル前に "configure" スクリプトに与えられるオプションに応じて最適化されている．
    現時点で，RedHat（sysv 形式），RedHat（systemd 形式），SUSE（sysv 形式），SUSE（systemd 形式），
    Debian（sysv 形式），Debian（systemd 形式），Gentoo，NetBSD，および Solaris 向けのテンプレートが用意されている．
    "configure" スクリプトにシステムタイプを指示することで，どのスタートアップスクリプト
      <a id="idm1159" class="indexterm"></a>を生成してインストールするのか選ぶことができる．
    スタートアップスクリプトを自動でインストールさせるには，
    <code class="option">--with-init-style</code> オプションで有効なものを "configure" に加える．</p><p>Linux ディストーションの新しいリリースは頻繁に出てくるし，
    上記で触れたようなほかのシステムのスタートアップの手続きもまた変わりうる．
    それ故，盲目的にスタートアップスクリプトをインストールするのではなく，
    自分のシステムで動作するであろうかということをまず見てみる，というのがおそらくいい考えである．
    Linux ディストーションの RPM あるいは BSD のパッケージのような所定のセットアップの一部として使用する場合，
    諸々の事は概ねよしなに取り計らわれるだろう．
    それ故，Netatalk そのものをコンパイルするユーザーには概ね下記のことが当てはまる．</p><p>いかなるスタートアップスクリプト機構を使っていても，下記のデーモンは必要である：</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>netatalk<a id="idm1168" class="indexterm"></a></p></li></ul></div><p>加えて，設定ファイル <code class="filename">afp.conf</code> が正しい場所にあるか確認する．</p></div></div><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="installation.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="upgrade.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第2章 インストール </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第4章 Netatalk 2 からのアップグレード</td></tr></table></div></body></html>