<div id="content">
<h1>Netatalk Security Advisory</h1>

<dl>
<dt><strong>Subject</strong></dt>
<dd>Arbitrary code execution in dsi_stream_receive</dd>
<dt><strong>CVE ID</strong></dt>
<dd><a href="https://www.cve.org/CVERecord?id=CVE-2021-31439">CVE-2021-31439</a></dd>
<dt><strong>Date of Publishing</strong></dt>
<dd>2022/03/21 <i>advisory published retroactively; date is approximate</i></dd>
<dt><strong>Affected Netatalk Versions</strong></dt>
<dd>3.0.0 - 3.1.12</dd>
<dt><strong>Summary</strong></dt>
<dd>Lack of limit checking in dsi_stream_receive leads to remote code execution</dd>
</dl>
<h2>Description</h2>
<p>This vulnerability allows network-adjacent attackers to execute arbitrary code in Netatalk.
Authentication is not required to exploit this vulnerablity.
The specific flaw exists within the processing of DSI structures in Netatalk.
The issue results from the lack of proper validation of the length of user-supplied data
prior to copying it to a heap-based buffer.
An attacker can leverage this vulnerability to execute code in the context of the current process.</p>

<h2>Patch Availability</h2>
<p>Apply the patch with git hash
<a href="https://github.com/Netatalk/netatalk/commit/779717df2ed39b701deaf2472b42d59ff50fab7f.diff">
779717d</a> to hotfix your local Netatalk deployment.</p>

<p>Additionally, Netatalk 3.1.13 has been released which contains the security patch.
Netatalk administrators are advised to upgrade to this version or apply the patch as soon as possible.</p>

<h2>CVSS Calculation</h2>
<p>CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H (8.8)</p>

<h2>Workaround</h2>
<p>None.</p>

<h2>Credits</h2>
<dl>
<dt>Vulnerability found and reported by:</dt>
<dd>Angelboy(@scwuaptx) from DEVCORE Security Team</dd>
<dt>Patch developed by:</dt>
<dd>Ralph Boehme of the Netatalk and Samba teams</dd>
</dl>

<p>
<a href="support.html">Go back to Support</a>
</p>

</div>
