<div id="content">
<h1>Netatalk Security Advisory</h1>

<dl>
<dt><strong>Subject</strong></dt>
<dd>papd daemon vulnerable to remote command execution</dd>
<dt><strong>CVE ID</strong></dt>
<dd><a href="https://www.cve.org/CVERecord?id=CVE-2008-5718">CVE-2008-5718</a></dd>
<dt><strong>Date of Publishing</strong></dt>
<dd>2009/11/10 <i>advisory published retroactively; date is approximate</i></dd>
<dt><strong>Affected Netatalk Versions</strong></dt>
<dd>2.0.0 - 2.0.4</dd>
<dt><strong>Summary</strong></dt>
<dd>Remote attacker able to execute arbitrary commands in a print request</dd>
</dl>
<h2>Description</h2>
<p>The papd daemon in Netatalk before version 2.0.5,
when using certain variables in a pipe command for the print file,
allows remote attackers to execute arbitrary commands via shell metacharacters in a print request,
as demonstrated using a crafted Title.</p>

<p>The vulnerability is caused by the papd daemon
improperly sanitising several received parameters before passing them in a call to "popen()".
This can be exploited to execute arbitrary commands via a specially crafted printing request.</p>

<p>Successful exploitation requires that a printer
is configured to pass arbitrary values as parameters to a piped command.</p>

<h2>Patch Availability</h2>
<p>Apply the patches with git hash
<a href="https://github.com/Netatalk/netatalk/commit/7fdf387c6afc7d07ee54a45d1e62e8572eeaa21d.diff">
7fdf387</a> and <a href="https://github.com/Netatalk/netatalk/commit/f850662e9231d6437be0ff72e537230fc0aacf79.diff">
f850662</a> to hotfix your local Netatalk deployment.</p>

<p>Additionally, Netatalk 2.0.5 has been released which contains the security patches.
Netatalk administrators are advised to upgrade to this version or apply the patch as soon as possible.</p>

<p>Note that the previous release, Netatalk 2.0.4, contained a partial fix for this vulnerability.</p>

<h2>CVSS Calculation</h2>
<p>CVSS:2.0/AV:N/AC:M/Au:N/C:C/I:C/A:C (9.3)</p>

<h2>Workaround</h2>
<p>None.</p>

<h2>Credits</h2>
<dl>
<dt>Vulnerability found and reported by:</dt>
<dd>Thomas Biege from the SUSE Security Team</dd>
<dt>Patch developed by:</dt>
<dd>Didier Gautheron and Frank Lahm of the Netatalk team</dd>
</dl>

</div>
