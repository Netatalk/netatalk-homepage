# Netatalk Security Advisory

| **Subject**  | Information leak in get_finderinfo |
| ------------ | -------------------------------------- |
| **CVE ID#**  | [CVE-2022-23124](https://www.cve.org/CVERecord?id=CVE-2022-23124) |
| **Date**     | 2022/03/21 *advisory published retroactively; date is approximate* |
| **Versions** | 3.0.0 - 3.1.12 |
| **Summary**  | Lack of validation of user-input data in the get_finderinfo function allows for reading past of allocated buffer |

## Description

This vulnerability allows remote attackers to disclose sensitive
information on affected installations of Netatalk. Authentication is not
required to exploit this vulnerability. The specific flaw exists within
the get_finderinfo method. The issue results from the lack of proper
validation of user-supplied data, which can result in a read past the
end of an allocated buffer. An attacker can leverage this in conjunction
with other vulnerabilities to execute arbitrary code in the context of
root.

## Patch Availability

Apply the patch with git hash
[4a8f6c9](https://github.com/Netatalk/netatalk/commit/4a8f6c964d5ca86df27c50e50dc1b60d39c9b76d.diff)
to hotfix your local Netatalk deployment.

Additionally, Netatalk 3.1.13 has been released which contains the
security patch. Netatalk administrators are advised to upgrade to this
version or apply the patch as soon as possible.

## CVSS Calculation

CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N (5.3)

## Workaround

None.

## Credits

Vulnerability found and reported by:

> Theori (@theori_io)

Patch developed by:

> Ralph Boehme of the Netatalk and Samba teams

---

Go back to the [Security Policy](security.html).
